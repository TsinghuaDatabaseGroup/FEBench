select 
Q3_Col31_1,
flatten_request_Q3_Col32_original_0,
flatten_request_Q3_Col31_original_1,
flatten_request_Q3_Col34_original_92,
flatten_request_Q3_Col3_original_93,
flatten_request_Q3_Col33_original_94,
flatten_request_Q3_Col3_95,
flatten_request_Q3_Col3_96,
flatten_request_Q3_Col3_97,
flatten_request_Q3_Col34_window_count_98,
Q3_Col31_3,
feedback_Q3_Col58_multi_direct_2,
product_Q3_Col3_Q3_Col60_multi_direct_15,
product_Q3_Col3_Q3_Col61_multi_direct_16,
product_Q3_Col3_Q3_Col0_multi_direct_17,
product_Q3_Col3_Q3_Col59_multi_direct_18,
product_Q3_Col3_Q3_Col64_multi_direct_19,
product_Q3_Col3_Q3_Col65_multi_direct_20,
product_Q3_Col3_Q3_Col62_multi_direct_21,
product_Q3_Col3_Q3_Col63_multi_direct_22,
product_item_Q3_Col12_multi_last_value_23,
product_item_Q3_Col16_multi_last_value_24,
product_item_Q3_Col26_multi_last_value_25,
product_item_Q3_Col27_multi_last_value_26,
product_item_Q3_Col9_multi_last_value_27,
product_item_Q3_Col11_multi_last_value_28,
product_item_Q3_Col8_multi_last_value_29,
product_item_Q3_Col7_multi_last_value_30,
product_item_Q3_Col18_multi_last_value_31,
product_item_Q3_Col20_multi_last_value_32,
product_item_Q3_Col21_multi_last_value_33,
product_item_Q3_Col22_multi_last_value_34,
product_item_Q3_Col23_multi_last_value_35,
product_item_Q3_Col24_multi_last_value_36,
product_item_Q3_Col25_multi_last_value_37,
product_item_Q3_Col19_multi_last_value_38,
product_item_Q3_Col14_multi_last_value_39,
product_item_Q3_Col15_multi_last_value_40,
shipping_Q3_Col3_Q3_Col54_multi_last_value_41,
shipping_Q3_Col3_Q3_Col68_multi_last_value_42,
shipping_Q3_Col3_Q3_Col67_multi_last_value_43,
shipping_Q3_Col3_Q3_Col66_multi_last_value_44,
Q3_Col31_4,
order_cancel_return_Q3_Col4_multi_avg_3,
Q3_Col31_5,
order_sales_Q3_Col48_multi_avg_4,
order_sales_Q3_Col48_multi_avg_4 / order_sales_Q3_Col55_multi_avg_12,
order_sales_Q3_Col48_multi_avg_5,
order_sales_Q3_Col48_multi_avg_5 / shipping_Q3_Col3_Q3_Col54_multi_last_value_41,
order_sales_Q3_Col48_multi_avg_5 / order_sales_Q3_Col54_multi_min_49,
order_sales_Q3_Col47_multi_avg_6,
order_sales_Q3_Col47_multi_avg_6 / order_sales_Q3_Col40_multi_unique_count_82,
order_sales_Q3_Col47_multi_avg_6 / order_sales_Q3_Col55_multi_avg_12,
order_sales_Q3_Col47_multi_avg_6 / order_sales_Q3_Col55_multi_avg_12,
order_sales_Q3_Col47_multi_avg_7,
order_sales_Q3_Col47_multi_avg_7 / order_sales_Q3_Col40_multi_unique_count_81,
order_sales_Q3_Col47_multi_avg_7 / shipping_Q3_Col3_Q3_Col54_multi_last_value_41,
order_sales_Q3_Col54_multi_avg_8,
order_sales_Q3_Col54_multi_avg_9,
order_sales_Q3_Col56_multi_avg_10,
order_sales_Q3_Col53_multi_avg_11,
order_sales_Q3_Col53_multi_avg_11 / order_sales_Q3_Col47_multi_avg_7,
order_sales_Q3_Col55_multi_avg_12,
order_sales_Q3_Col4_multi_avg_13,
order_sales_Q3_Col4_multi_avg_14,
order_sales_Q3_Col4_multi_avg_14 / order_sales_Q3_Col55_multi_avg_12,
order_sales_Q3_Col56_multi_max_45,
order_sales_Q3_Col4_multi_max_46,
order_sales_Q3_Col48_multi_min_47,
order_sales_Q3_Col47_multi_min_48,
order_sales_Q3_Col54_multi_min_49,
order_sales_Q3_Col54_multi_min_49 / order_sales_Q3_Col48_multi_avg_5,
order_sales_Q3_Col56_multi_min_50,
order_sales_Q3_Col43_multi_top3frequency_51,
order_sales_Q3_Col43_multi_top3frequency_52,
order_sales_Q3_Col44_multi_top3frequency_53,
order_sales_Q3_Col40_multi_top3frequency_54,
order_sales_Q3_Col41_multi_top3frequency_55,
order_sales_Q3_Col42_multi_top3frequency_56,
order_sales_Q3_Col39_multi_top3frequency_57,
order_sales_Q3_Col39_multi_top3frequency_58,
order_sales_Q3_Col38_multi_top3frequency_59,
order_sales_Q3_Col38_multi_top3frequency_60,
order_sales_Q3_Col6_multi_top3frequency_61,
order_sales_Q3_Col6_multi_top3frequency_62,
order_sales_Q3_Col2_multi_top3frequency_63,
order_sales_Q3_Col2_multi_top3frequency_64,
order_sales_Q3_Col45_multi_top3frequency_65,
order_sales_Q3_Col45_multi_top3frequency_66,
order_sales_Q3_Col35_multi_top3frequency_67,
order_sales_Q3_Col35_multi_top3frequency_68,
order_sales_Q3_Col57_multi_top3frequency_69,
order_sales_Q3_Col57_multi_top3frequency_70,
order_sales_Q3_Col36_multi_top3frequency_71,
order_sales_Q3_Col51_multi_top3frequency_72,
order_sales_Q3_Col51_multi_top3frequency_73,
order_sales_Q3_Col52_multi_top3frequency_74,
order_sales_Q3_Col52_multi_top3frequency_75,
order_sales_Q3_Col50_multi_top3frequency_76,
order_sales_Q3_Col50_multi_top3frequency_77,
order_sales_Q3_Col43_multi_unique_count_78,
order_sales_Q3_Col43_multi_unique_count_78 / order_sales_Q3_Col55_multi_avg_12,
order_sales_Q3_Col44_multi_unique_count_79,
order_sales_Q3_Col44_multi_unique_count_80,
order_sales_Q3_Col40_multi_unique_count_81,
order_sales_Q3_Col40_multi_unique_count_82,
order_sales_Q3_Col40_multi_unique_count_82 / order_sales_Q3_Col47_multi_avg_6,
order_sales_Q3_Col41_multi_unique_count_83,
order_sales_Q3_Col41_multi_unique_count_84,
order_sales_Q3_Col39_multi_unique_count_85,
order_sales_Q3_Col38_multi_unique_count_86,
order_sales_Q3_Col2_multi_unique_count_87,
order_sales_Q3_Col2_multi_unique_count_87 / order_sales_Q3_Col55_multi_avg_12,
order_sales_Q3_Col45_multi_unique_count_88,
order_sales_Q3_Col35_multi_unique_count_89,
order_sales_Q3_Col36_multi_unique_count_90,
order_sales_Q3_Col36_multi_unique_count_91
from 
(
select
`Q3_Col31` as Q3_Col31_1,
`Q3_Col32` as flatten_request_Q3_Col32_original_0,
`Q3_Col31` as flatten_request_Q3_Col31_original_1,
`Q3_Col34` as flatten_request_Q3_Col34_original_92,
`Q3_Col3` as flatten_request_Q3_Col3_original_93,
`Q3_Col33` as flatten_request_Q3_Col33_original_94,
`Q3_Col3` as flatten_request_Q3_Col3_95,
`Q3_Col3` as flatten_request_Q3_Col3_96,
`Q3_Col3` as flatten_request_Q3_Col3_97,
case when !isnull(at(`Q3_Col34`, 0)) over flatten_request_Q3_Col3_Q3_Col32_0s_7d_100 then count_where(`Q3_Col34`, `Q3_Col34` = at(`Q3_Col34`, 0)) over flatten_request_Q3_Col3_Q3_Col32_0s_7d_100 else null end as flatten_request_Q3_Col34_window_count_98
from
`train`
window flatten_request_Q3_Col3_Q3_Col32_0s_7d_100 as (partition by `Q3_Col3` order by `Q3_Col32` rows_range between 7d preceding and 0s preceding MAXSIZE 100))
as out0
last join
(
select
`train`.`Q3_Col31` as Q3_Col31_3,
`feedback_Q3_Col31`.`Q3_Col58` as feedback_Q3_Col58_multi_direct_2,
`product_Q3_Col3_Q3_Col3`.`Q3_Col60` as product_Q3_Col3_Q3_Col60_multi_direct_15,
`product_Q3_Col3_Q3_Col3`.`Q3_Col61` as product_Q3_Col3_Q3_Col61_multi_direct_16,
`product_Q3_Col3_Q3_Col3`.`Q3_Col0` as product_Q3_Col3_Q3_Col0_multi_direct_17,
`product_Q3_Col3_Q3_Col3`.`Q3_Col59` as product_Q3_Col3_Q3_Col59_multi_direct_18,
`product_Q3_Col3_Q3_Col3`.`Q3_Col64` as product_Q3_Col3_Q3_Col64_multi_direct_19,
`product_Q3_Col3_Q3_Col3`.`Q3_Col65` as product_Q3_Col3_Q3_Col65_multi_direct_20,
`product_Q3_Col3_Q3_Col3`.`Q3_Col62` as product_Q3_Col3_Q3_Col62_multi_direct_21,
`product_Q3_Col3_Q3_Col3`.`Q3_Col63` as product_Q3_Col3_Q3_Col63_multi_direct_22,
`product_item_Q3_Col6__Q3_Col32_0s_1d`.`Q3_Col12` as product_item_Q3_Col12_multi_last_value_23,
`product_item_Q3_Col6__Q3_Col32_0s_1d`.`Q3_Col16` as product_item_Q3_Col16_multi_last_value_24,
`product_item_Q3_Col6__Q3_Col32_0s_1d`.`Q3_Col26` as product_item_Q3_Col26_multi_last_value_25,
`product_item_Q3_Col6__Q3_Col32_0s_1d`.`Q3_Col27` as product_item_Q3_Col27_multi_last_value_26,
`product_item_Q3_Col6__Q3_Col32_0s_1d`.`Q3_Col9` as product_item_Q3_Col9_multi_last_value_27,
`product_item_Q3_Col6__Q3_Col32_0s_1d`.`Q3_Col11` as product_item_Q3_Col11_multi_last_value_28,
`product_item_Q3_Col6__Q3_Col32_0s_1d`.`Q3_Col8` as product_item_Q3_Col8_multi_last_value_29,
`product_item_Q3_Col6__Q3_Col32_0s_1d`.`Q3_Col7` as product_item_Q3_Col7_multi_last_value_30,
`product_item_Q3_Col6__Q3_Col32_0s_1d`.`Q3_Col18` as product_item_Q3_Col18_multi_last_value_31,
`product_item_Q3_Col6__Q3_Col32_0s_1d`.`Q3_Col20` as product_item_Q3_Col20_multi_last_value_32,
`product_item_Q3_Col6__Q3_Col32_0s_1d`.`Q3_Col21` as product_item_Q3_Col21_multi_last_value_33,
`product_item_Q3_Col6__Q3_Col32_0s_1d`.`Q3_Col22` as product_item_Q3_Col22_multi_last_value_34,
`product_item_Q3_Col6__Q3_Col32_0s_1d`.`Q3_Col23` as product_item_Q3_Col23_multi_last_value_35,
`product_item_Q3_Col6__Q3_Col32_0s_1d`.`Q3_Col24` as product_item_Q3_Col24_multi_last_value_36,
`product_item_Q3_Col6__Q3_Col32_0s_1d`.`Q3_Col25` as product_item_Q3_Col25_multi_last_value_37,
`product_item_Q3_Col6__Q3_Col32_0s_1d`.`Q3_Col19` as product_item_Q3_Col19_multi_last_value_38,
`product_item_Q3_Col6__Q3_Col32_0s_1d`.`Q3_Col14` as product_item_Q3_Col14_multi_last_value_39,
`product_item_Q3_Col6__Q3_Col32_0s_1d`.`Q3_Col15` as product_item_Q3_Col15_multi_last_value_40,
`shipping_Q3_Col3_Q3_Col3__Q3_Col32_0s_1d`.`Q3_Col54` as shipping_Q3_Col3_Q3_Col54_multi_last_value_41,
`shipping_Q3_Col3_Q3_Col3__Q3_Col32_0s_1d`.`Q3_Col68` as shipping_Q3_Col3_Q3_Col68_multi_last_value_42,
`shipping_Q3_Col3_Q3_Col3__Q3_Col32_0s_1d`.`Q3_Col67` as shipping_Q3_Col3_Q3_Col67_multi_last_value_43,
`shipping_Q3_Col3_Q3_Col3__Q3_Col32_0s_1d`.`Q3_Col66` as shipping_Q3_Col3_Q3_Col66_multi_last_value_44
from
`train`
last join `feedback` as `feedback_Q3_Col31` on `train`.`Q3_Col31` = `feedback_Q3_Col31`.`Q3_Col31`
last join `product_sku` as `product_Q3_Col3_Q3_Col3` on `train`.`Q3_Col3` = `product_Q3_Col3_Q3_Col3`.`Q3_Col3`
last join `product_item` as `product_item_Q3_Col6__Q3_Col32_0s_1d` order by product_item_Q3_Col6__Q3_Col32_0s_1d.`Q3_Col0` on `train`.`Q3_Col6` = `product_item_Q3_Col6__Q3_Col32_0s_1d`.`Q3_Col6` and `product_item_Q3_Col6__Q3_Col32_0s_1d`.`Q3_Col0` < `train`.`Q3_Col32` - 0 and `product_item_Q3_Col6__Q3_Col32_0s_1d`.`Q3_Col0` > `train`.`Q3_Col32` - 86400000
last join `shipping_sku` as `shipping_Q3_Col3_Q3_Col3__Q3_Col32_0s_1d` order by shipping_Q3_Col3_Q3_Col3__Q3_Col32_0s_1d.`Q3_Col0` on `train`.`Q3_Col3` = `shipping_Q3_Col3_Q3_Col3__Q3_Col32_0s_1d`.`Q3_Col3` and `shipping_Q3_Col3_Q3_Col3__Q3_Col32_0s_1d`.`Q3_Col0` < `train`.`Q3_Col32` - 0 and `shipping_Q3_Col3_Q3_Col3__Q3_Col32_0s_1d`.`Q3_Col0` > `train`.`Q3_Col32` - 86400000)
as out1
on out0.Q3_Col31_1 = out1.Q3_Col31_3
last join
(
select
`Q3_Col31` as Q3_Col31_4,
avg(`Q3_Col4`) over order_cancel_return_Q3_Col3_Q3_Col0_0s_64d_100 as order_cancel_return_Q3_Col4_multi_avg_3
from
(select `Q3_Col32` as `Q3_Col0`, timestamp('2019-07-18 09:20:20') as `Q3_Col1`, '' as `Q3_Col2`, `Q3_Col3` as `Q3_Col3`, int(0) as `Q3_Col4`, '' as `Q3_Col5`, Q3_Col31 from `train`)
window order_cancel_return_Q3_Col3_Q3_Col0_0s_64d_100 as (
UNION (select `Q3_Col0`, `Q3_Col1`, `Q3_Col2`, `Q3_Col3`, `Q3_Col4`, `Q3_Col5`, '' as Q3_Col31 from `order_cancel_return`) partition by `Q3_Col3` order by `Q3_Col0` rows_range between 64d preceding and 0s preceding MAXSIZE 100 INSTANCE_NOT_IN_WINDOW))
as out2
on out0.Q3_Col31_1 = out2.Q3_Col31_4
last join
(
select
`Q3_Col31` as Q3_Col31_5,
avg(`Q3_Col48`) over order_sales_Q3_Col3_Q3_Col0_0s_10h_100 as order_sales_Q3_Col48_multi_avg_4,
avg(`Q3_Col48`) over order_sales_Q3_Col3_Q3_Col0_0s_2d_100 as order_sales_Q3_Col48_multi_avg_5,
avg(`Q3_Col47`) over order_sales_Q3_Col3_Q3_Col0_0s_10h_100 as order_sales_Q3_Col47_multi_avg_6,
avg(`Q3_Col47`) over order_sales_Q3_Col3_Q3_Col0_0s_2d_100 as order_sales_Q3_Col47_multi_avg_7,
avg(`Q3_Col54`) over order_sales_Q3_Col3_Q3_Col0_0s_14d_100 as order_sales_Q3_Col54_multi_avg_8,
avg(`Q3_Col54`) over order_sales_Q3_Col3_Q3_Col0_0s_2d_100 as order_sales_Q3_Col54_multi_avg_9,
avg(`Q3_Col56`) over order_sales_Q3_Col3_Q3_Col0_0s_5d_100 as order_sales_Q3_Col56_multi_avg_10,
avg(`Q3_Col53`) over order_sales_Q3_Col3_Q3_Col0_0s_10h_100 as order_sales_Q3_Col53_multi_avg_11,
avg(`Q3_Col55`) over order_sales_Q3_Col3_Q3_Col0_0s_5d_100 as order_sales_Q3_Col55_multi_avg_12,
avg(`Q3_Col4`) over order_sales_Q3_Col3_Q3_Col0_0s_10h_100 as order_sales_Q3_Col4_multi_avg_13,
avg(`Q3_Col4`) over order_sales_Q3_Col3_Q3_Col0_0s_2d_100 as order_sales_Q3_Col4_multi_avg_14,
max(`Q3_Col56`) over order_sales_Q3_Col3_Q3_Col0_0s_14d_100 as order_sales_Q3_Col56_multi_max_45,
max(`Q3_Col4`) over order_sales_Q3_Col3_Q3_Col0_0s_10h_100 as order_sales_Q3_Col4_multi_max_46,
min(`Q3_Col48`) over order_sales_Q3_Col3_Q3_Col0_0s_2d_100 as order_sales_Q3_Col48_multi_min_47,
min(`Q3_Col47`) over order_sales_Q3_Col3_Q3_Col0_0s_2d_100 as order_sales_Q3_Col47_multi_min_48,
min(`Q3_Col54`) over order_sales_Q3_Col3_Q3_Col0_0s_2d_100 as order_sales_Q3_Col54_multi_min_49,
min(`Q3_Col56`) over order_sales_Q3_Col3_Q3_Col0_0s_64d_100 as order_sales_Q3_Col56_multi_min_50,
topn_frequency(`Q3_Col43`, 3) over order_sales_Q3_Col3_Q3_Col0_0s_14d_100 as order_sales_Q3_Col43_multi_top3frequency_51,
topn_frequency(`Q3_Col43`, 3) over order_sales_Q3_Col3_Q3_Col0_0s_64d_100 as order_sales_Q3_Col43_multi_top3frequency_52,
topn_frequency(`Q3_Col44`, 3) over order_sales_Q3_Col3_Q3_Col0_0s_10h_100 as order_sales_Q3_Col44_multi_top3frequency_53,
topn_frequency(`Q3_Col40`, 3) over order_sales_Q3_Col3_Q3_Col0_0s_10h_100 as order_sales_Q3_Col40_multi_top3frequency_54,
topn_frequency(`Q3_Col41`, 3) over order_sales_Q3_Col3_Q3_Col0_0s_5d_100 as order_sales_Q3_Col41_multi_top3frequency_55,
topn_frequency(`Q3_Col42`, 3) over order_sales_Q3_Col3_Q3_Col0_0s_5d_100 as order_sales_Q3_Col42_multi_top3frequency_56,
topn_frequency(`Q3_Col39`, 3) over order_sales_Q3_Col3_Q3_Col0_0s_10h_100 as order_sales_Q3_Col39_multi_top3frequency_57,
topn_frequency(`Q3_Col39`, 3) over order_sales_Q3_Col3_Q3_Col0_0s_2d_100 as order_sales_Q3_Col39_multi_top3frequency_58,
topn_frequency(`Q3_Col38`, 3) over order_sales_Q3_Col3_Q3_Col0_0s_5d_100 as order_sales_Q3_Col38_multi_top3frequency_59,
topn_frequency(`Q3_Col38`, 3) over order_sales_Q3_Col3_Q3_Col0_0s_64d_100 as order_sales_Q3_Col38_multi_top3frequency_60,
topn_frequency(`Q3_Col6`, 3) over order_sales_Q3_Col3_Q3_Col0_0s_10h_100 as order_sales_Q3_Col6_multi_top3frequency_61,
topn_frequency(`Q3_Col6`, 3) over order_sales_Q3_Col3_Q3_Col0_0s_5d_100 as order_sales_Q3_Col6_multi_top3frequency_62,
topn_frequency(`Q3_Col2`, 3) over order_sales_Q3_Col3_Q3_Col0_0s_14d_100 as order_sales_Q3_Col2_multi_top3frequency_63,
topn_frequency(`Q3_Col2`, 3) over order_sales_Q3_Col3_Q3_Col0_0s_64d_100 as order_sales_Q3_Col2_multi_top3frequency_64,
topn_frequency(`Q3_Col45`, 3) over order_sales_Q3_Col3_Q3_Col0_0s_14d_100 as order_sales_Q3_Col45_multi_top3frequency_65,
topn_frequency(`Q3_Col45`, 3) over order_sales_Q3_Col3_Q3_Col0_0s_7d_100 as order_sales_Q3_Col45_multi_top3frequency_66,
topn_frequency(`Q3_Col35`, 3) over order_sales_Q3_Col3_Q3_Col0_0s_14d_100 as order_sales_Q3_Col35_multi_top3frequency_67,
topn_frequency(`Q3_Col35`, 3) over order_sales_Q3_Col3_Q3_Col0_0s_64d_100 as order_sales_Q3_Col35_multi_top3frequency_68,
topn_frequency(`Q3_Col57`, 3) over order_sales_Q3_Col3_Q3_Col0_0s_10h_100 as order_sales_Q3_Col57_multi_top3frequency_69,
topn_frequency(`Q3_Col57`, 3) over order_sales_Q3_Col3_Q3_Col0_0s_5d_100 as order_sales_Q3_Col57_multi_top3frequency_70,
topn_frequency(`Q3_Col36`, 3) over order_sales_Q3_Col3_Q3_Col0_0s_10h_100 as order_sales_Q3_Col36_multi_top3frequency_71,
topn_frequency(`Q3_Col51`, 3) over order_sales_Q3_Col3_Q3_Col0_0s_10h_100 as order_sales_Q3_Col51_multi_top3frequency_72,
topn_frequency(`Q3_Col51`, 3) over order_sales_Q3_Col3_Q3_Col0_0s_2d_100 as order_sales_Q3_Col51_multi_top3frequency_73,
topn_frequency(`Q3_Col52`, 3) over order_sales_Q3_Col3_Q3_Col0_0s_10h_100 as order_sales_Q3_Col52_multi_top3frequency_74,
topn_frequency(`Q3_Col52`, 3) over order_sales_Q3_Col3_Q3_Col0_0s_2d_100 as order_sales_Q3_Col52_multi_top3frequency_75,
topn_frequency(`Q3_Col50`, 3) over order_sales_Q3_Col3_Q3_Col0_0s_10h_100 as order_sales_Q3_Col50_multi_top3frequency_76,
topn_frequency(`Q3_Col50`, 3) over order_sales_Q3_Col3_Q3_Col0_0s_7d_100 as order_sales_Q3_Col50_multi_top3frequency_77,
distinct_count(`Q3_Col43`) over order_sales_Q3_Col3_Q3_Col0_0s_10h_100 as order_sales_Q3_Col43_multi_unique_count_78,
distinct_count(`Q3_Col44`) over order_sales_Q3_Col3_Q3_Col0_0s_10h_100 as order_sales_Q3_Col44_multi_unique_count_79,
distinct_count(`Q3_Col44`) over order_sales_Q3_Col3_Q3_Col0_0s_2d_100 as order_sales_Q3_Col44_multi_unique_count_80,
distinct_count(`Q3_Col40`) over order_sales_Q3_Col3_Q3_Col0_0s_10h_100 as order_sales_Q3_Col40_multi_unique_count_81,
distinct_count(`Q3_Col40`) over order_sales_Q3_Col3_Q3_Col0_0s_2d_100 as order_sales_Q3_Col40_multi_unique_count_82,
distinct_count(`Q3_Col41`) over order_sales_Q3_Col3_Q3_Col0_0s_10h_100 as order_sales_Q3_Col41_multi_unique_count_83,
distinct_count(`Q3_Col41`) over order_sales_Q3_Col3_Q3_Col0_0s_64d_100 as order_sales_Q3_Col41_multi_unique_count_84,
distinct_count(`Q3_Col39`) over order_sales_Q3_Col3_Q3_Col0_0s_10h_100 as order_sales_Q3_Col39_multi_unique_count_85,
distinct_count(`Q3_Col38`) over order_sales_Q3_Col3_Q3_Col0_0s_10h_100 as order_sales_Q3_Col38_multi_unique_count_86,
distinct_count(`Q3_Col2`) over order_sales_Q3_Col3_Q3_Col0_0s_10h_100 as order_sales_Q3_Col2_multi_unique_count_87,
distinct_count(`Q3_Col45`) over order_sales_Q3_Col3_Q3_Col0_0s_10h_100 as order_sales_Q3_Col45_multi_unique_count_88,
distinct_count(`Q3_Col35`) over order_sales_Q3_Col3_Q3_Col0_0s_10h_100 as order_sales_Q3_Col35_multi_unique_count_89,
distinct_count(`Q3_Col36`) over order_sales_Q3_Col3_Q3_Col0_0s_10h_100 as order_sales_Q3_Col36_multi_unique_count_90,
distinct_count(`Q3_Col36`) over order_sales_Q3_Col3_Q3_Col0_0s_2d_100 as order_sales_Q3_Col36_multi_unique_count_91
from
(select `Q3_Col32` as `Q3_Col0`, '' as `Q3_Col35`, '' as `Q3_Col36`, '' as `Q3_Col37`, '' as `Q3_Col38`, '' as `Q3_Col39`, '' as `Q3_Col40`, '' as `Q3_Col41`, '' as `Q3_Col42`, '' as `Q3_Col2`, '' as `Q3_Col43`, '' as `Q3_Col44`, '' as `Q3_Col45`, timestamp('2019-07-18 09:20:20') as `Q3_Col46`, bigint(0) as `Q3_Col4`, double(0) as `Q3_Col47`, double(0) as `Q3_Col48`, `Q3_Col3` as `Q3_Col3`, '' as `Q3_Col49`, '' as `Q3_Col50`, '' as `Q3_Col6`, '' as `Q3_Col51`, '' as `Q3_Col52`, double(0) as `Q3_Col53`, double(0) as `Q3_Col54`, double(0) as `Q3_Col55`, double(0) as `Q3_Col56`, '' as `Q3_Col57`, Q3_Col31 from `train`)
window order_sales_Q3_Col3_Q3_Col0_0s_10h_100 as (
UNION (select `Q3_Col0`, `Q3_Col35`, `Q3_Col36`, `Q3_Col37`, `Q3_Col38`, `Q3_Col39`, `Q3_Col40`, `Q3_Col41`, `Q3_Col42`, `Q3_Col2`, `Q3_Col43`, `Q3_Col44`, `Q3_Col45`, `Q3_Col46`, `Q3_Col4`, `Q3_Col47`, `Q3_Col48`, `Q3_Col3`, `Q3_Col49`, `Q3_Col50`, `Q3_Col6`, `Q3_Col51`, `Q3_Col52`, `Q3_Col53`, `Q3_Col54`, `Q3_Col55`, `Q3_Col56`, `Q3_Col57`, '' as Q3_Col31 from `order_sales`) partition by `Q3_Col3` order by `Q3_Col0` rows_range between 10h preceding and 0s preceding MAXSIZE 100 INSTANCE_NOT_IN_WINDOW),
order_sales_Q3_Col3_Q3_Col0_0s_2d_100 as (
UNION (select `Q3_Col0`, `Q3_Col35`, `Q3_Col36`, `Q3_Col37`, `Q3_Col38`, `Q3_Col39`, `Q3_Col40`, `Q3_Col41`, `Q3_Col42`, `Q3_Col2`, `Q3_Col43`, `Q3_Col44`, `Q3_Col45`, `Q3_Col46`, `Q3_Col4`, `Q3_Col47`, `Q3_Col48`, `Q3_Col3`, `Q3_Col49`, `Q3_Col50`, `Q3_Col6`, `Q3_Col51`, `Q3_Col52`, `Q3_Col53`, `Q3_Col54`, `Q3_Col55`, `Q3_Col56`, `Q3_Col57`, '' as Q3_Col31 from `order_sales`) partition by `Q3_Col3` order by `Q3_Col0` rows_range between 2d preceding and 0s preceding MAXSIZE 100 INSTANCE_NOT_IN_WINDOW),
order_sales_Q3_Col3_Q3_Col0_0s_14d_100 as (
UNION (select `Q3_Col0`, `Q3_Col35`, `Q3_Col36`, `Q3_Col37`, `Q3_Col38`, `Q3_Col39`, `Q3_Col40`, `Q3_Col41`, `Q3_Col42`, `Q3_Col2`, `Q3_Col43`, `Q3_Col44`, `Q3_Col45`, `Q3_Col46`, `Q3_Col4`, `Q3_Col47`, `Q3_Col48`, `Q3_Col3`, `Q3_Col49`, `Q3_Col50`, `Q3_Col6`, `Q3_Col51`, `Q3_Col52`, `Q3_Col53`, `Q3_Col54`, `Q3_Col55`, `Q3_Col56`, `Q3_Col57`, '' as Q3_Col31 from `order_sales`) partition by `Q3_Col3` order by `Q3_Col0` rows_range between 14d preceding and 0s preceding MAXSIZE 100 INSTANCE_NOT_IN_WINDOW),
order_sales_Q3_Col3_Q3_Col0_0s_5d_100 as (
UNION (select `Q3_Col0`, `Q3_Col35`, `Q3_Col36`, `Q3_Col37`, `Q3_Col38`, `Q3_Col39`, `Q3_Col40`, `Q3_Col41`, `Q3_Col42`, `Q3_Col2`, `Q3_Col43`, `Q3_Col44`, `Q3_Col45`, `Q3_Col46`, `Q3_Col4`, `Q3_Col47`, `Q3_Col48`, `Q3_Col3`, `Q3_Col49`, `Q3_Col50`, `Q3_Col6`, `Q3_Col51`, `Q3_Col52`, `Q3_Col53`, `Q3_Col54`, `Q3_Col55`, `Q3_Col56`, `Q3_Col57`, '' as Q3_Col31 from `order_sales`) partition by `Q3_Col3` order by `Q3_Col0` rows_range between 5d preceding and 0s preceding MAXSIZE 100 INSTANCE_NOT_IN_WINDOW),
order_sales_Q3_Col3_Q3_Col0_0s_64d_100 as (
UNION (select `Q3_Col0`, `Q3_Col35`, `Q3_Col36`, `Q3_Col37`, `Q3_Col38`, `Q3_Col39`, `Q3_Col40`, `Q3_Col41`, `Q3_Col42`, `Q3_Col2`, `Q3_Col43`, `Q3_Col44`, `Q3_Col45`, `Q3_Col46`, `Q3_Col4`, `Q3_Col47`, `Q3_Col48`, `Q3_Col3`, `Q3_Col49`, `Q3_Col50`, `Q3_Col6`, `Q3_Col51`, `Q3_Col52`, `Q3_Col53`, `Q3_Col54`, `Q3_Col55`, `Q3_Col56`, `Q3_Col57`, '' as Q3_Col31 from `order_sales`) partition by `Q3_Col3` order by `Q3_Col0` rows_range between 64d preceding and 0s preceding MAXSIZE 100 INSTANCE_NOT_IN_WINDOW),
order_sales_Q3_Col3_Q3_Col0_0s_7d_100 as (
UNION (select `Q3_Col0`, `Q3_Col35`, `Q3_Col36`, `Q3_Col37`, `Q3_Col38`, `Q3_Col39`, `Q3_Col40`, `Q3_Col41`, `Q3_Col42`, `Q3_Col2`, `Q3_Col43`, `Q3_Col44`, `Q3_Col45`, `Q3_Col46`, `Q3_Col4`, `Q3_Col47`, `Q3_Col48`, `Q3_Col3`, `Q3_Col49`, `Q3_Col50`, `Q3_Col6`, `Q3_Col51`, `Q3_Col52`, `Q3_Col53`, `Q3_Col54`, `Q3_Col55`, `Q3_Col56`, `Q3_Col57`, '' as Q3_Col31 from `order_sales`) partition by `Q3_Col3` order by `Q3_Col0` rows_range between 7d preceding and 0s preceding MAXSIZE 100 INSTANCE_NOT_IN_WINDOW))
as out3
on out0.Q3_Col31_1 = out3.Q3_Col31_5
;
