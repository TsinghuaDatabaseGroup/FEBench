select 
Q4_Col40_1,
flattenRequest_Q4_Col41_original_0,
flattenRequest_Q4_Col40_original_1,
flattenRequest_Q4_Col39_original_107,
flattenRequest_Q4_Col45_original_108,
flattenRequest_Q4_Col47_original_109,
flattenRequest_Q4_Col187_original_110,
flattenRequest_Q4_Col186_original_111,
flattenRequest_Q4_Col189_original_112,
flattenRequest_Q4_Col190_original_113,
flattenRequest_Q4_Col188_original_114,
flattenRequest_Q4_Col191_original_115,
flattenRequest_Q4_Col114_original_116,
flattenRequest_Q4_Col142_original_117,
flattenRequest_Q4_Col128_original_118,
flattenRequest_Q4_Col115_original_119,
flattenRequest_Q4_Col143_original_120,
flattenRequest_Q4_Col129_original_121,
flattenRequest_Q4_Col90_original_122,
flattenRequest_Q4_Col105_original_123,
flattenRequest_Q4_Col80_original_124,
flattenRequest_Q4_Col118_original_125,
flattenRequest_Q4_Col146_original_126,
flattenRequest_Q4_Col132_original_127,
flattenRequest_Q4_Col81_original_128,
flattenRequest_Q4_Col97_original_129,
flattenRequest_Q4_Col165_original_130,
flattenRequest_Q4_Col96_original_131,
flattenRequest_Q4_Col162_original_132,
flattenRequest_Q4_Col164_original_133,
flattenRequest_Q4_Col119_original_134,
flattenRequest_Q4_Col147_original_135,
flattenRequest_Q4_Col133_original_136,
flattenRequest_Q4_Col160_original_137,
flattenRequest_Q4_Col120_original_138,
flattenRequest_Q4_Col148_original_139,
flattenRequest_Q4_Col134_original_140,
flattenRequest_Q4_Col82_original_141,
flattenRequest_Q4_Col83_original_142,
flattenRequest_Q4_Col84_original_143,
flattenRequest_Q4_Col102_original_144,
flattenRequest_Q4_Col177_original_145,
flattenRequest_Q4_Col178_original_146,
flattenRequest_Q4_Col180_original_147,
flattenRequest_Q4_Col182_original_148,
flattenRequest_Q4_Col183_original_149,
flattenRequest_Q4_Col166_original_150,
flattenRequest_Q4_Col184_original_151,
flattenRequest_Q4_Col185_original_152,
flattenRequest_Q4_Col167_original_153,
flattenRequest_Q4_Col169_original_154,
flattenRequest_Q4_Col170_original_155,
flattenRequest_Q4_Col172_original_156,
flattenRequest_Q4_Col104_original_157,
flattenRequest_Q4_Col100_original_158,
flattenRequest_Q4_Col88_original_159,
flattenRequest_Q4_Col89_original_160,
flattenRequest_Q4_Col103_original_161,
flattenRequest_Q4_Col101_original_162,
flattenRequest_Q4_Col121_original_163,
flattenRequest_Q4_Col149_original_164,
flattenRequest_Q4_Col135_original_165,
flattenRequest_Q4_Col122_original_166,
flattenRequest_Q4_Col150_original_167,
flattenRequest_Q4_Col136_original_168,
flattenRequest_Q4_Col156_original_169,
flattenRequest_Q4_Col49_original_170,
flattenRequest_Q4_Col157_original_171,
flattenRequest_Q4_Col123_original_172,
flattenRequest_Q4_Col151_original_173,
flattenRequest_Q4_Col137_original_174,
flattenRequest_Q4_Col113_original_175,
flattenRequest_Q4_Col124_original_176,
flattenRequest_Q4_Col152_original_177,
flattenRequest_Q4_Col138_original_178,
flattenRequest_Q4_Col125_original_179,
flattenRequest_Q4_Col153_original_180,
flattenRequest_Q4_Col139_original_181,
flattenRequest_Q4_Col43_original_182,
flattenRequest_Q4_Col78_original_183,
flattenRequest_Q4_Col92_original_184,
flattenRequest_Q4_Col93_original_185,
flattenRequest_Q4_Col91_original_186,
flattenRequest_Q4_Col59_original_187,
flattenRequest_Q4_Col126_original_188,
flattenRequest_Q4_Col154_original_189,
flattenRequest_Q4_Col140_original_190,
flattenRequest_Q4_Col127_original_191,
flattenRequest_Q4_Col155_original_192,
flattenRequest_Q4_Col141_original_193,
flattenRequest_Q4_Col161_original_194,
flattenRequest_Q4_Col163_original_195,
flattenRequest_Q4_Col79_original_196,
flattenRequest_Q4_Col77_original_197,
flattenRequest_Q4_Col98_original_198,
flattenRequest_Q4_Col94_original_199,
flattenRequest_Q4_Col106_original_200,
flattenRequest_Q4_Col107_original_201,
flattenRequest_Q4_Col111_original_202,
flattenRequest_Q4_Col112_original_203,
flattenRequest_Q4_Col108_original_204,
flattenRequest_Q4_Col109_original_205,
flattenRequest_Q4_Col158_original_206,
flattenRequest_Q4_Col159_original_207,
flattenRequest_Q4_Col48_original_208,
flattenRequest_Q4_Col116_original_209,
flattenRequest_Q4_Col144_original_210,
flattenRequest_Q4_Col130_original_211,
flattenRequest_Q4_Col117_original_212,
flattenRequest_Q4_Col145_original_213,
flattenRequest_Q4_Col131_original_214,
flattenRequest_Q4_Col45_divide_215,
flattenRequest_Q4_Col45_divide_215 / flattenRequest_Q4_Col39_divide_215,
flattenRequest_Q4_Col39_divide_215,
flattenRequest_Q4_Col39_divide_216,
flattenRequest_Q4_Col39_divide_216 / flattenRequest_Q4_Col45_divide_216,
flattenRequest_Q4_Col45_divide_216,
flattenRequest_Q4_Col47_divide_217,
flattenRequest_Q4_Col47_divide_217 / flattenRequest_Q4_Col39_divide_217,
flattenRequest_Q4_Col39_divide_217,
flattenRequest_Q4_Col39_divide_218,
flattenRequest_Q4_Col39_divide_218 / flattenRequest_Q4_Col47_divide_218,
flattenRequest_Q4_Col47_divide_218,
flattenRequest_Q4_Col83_multiply_219,
flattenRequest_Q4_Col83_multiply_219 * flattenRequest_Q4_Col84_multiply_219,
flattenRequest_Q4_Col84_multiply_219,
flattenRequest_Q4_Col47_divide_220,
flattenRequest_Q4_Col47_divide_220 / bo_previous_applicatio_Q4_Col58_multi_unique_count_94,
flattenRequest_Q4_Col47_divide_221,
flattenRequest_Q4_Col47_divide_221 / flattenRequest_Q4_Col45_divide_221,
flattenRequest_Q4_Col45_divide_221,
flattenRequest_Q4_Col80_combine_222,
concat(flattenRequest_Q4_Col80_combine_222,flattenRequest_Q4_Col92_combine_222),
flattenRequest_Q4_Col92_combine_222,
flattenRequest_Q4_Col45_divide_223,
flattenRequest_Q4_Col45_divide_223 / flattenRequest_Q4_Col47_divide_223,
flattenRequest_Q4_Col47_divide_223,
flattenRequest_Q4_Col159_combine_224,
concat(flattenRequest_Q4_Col159_combine_224,bo_POS_CASH_balance_Q4_Col23_multi_top3frequency_224),
flattenRequest_Q4_Col160_combine_225,
concat(flattenRequest_Q4_Col160_combine_225,bo_POS_CASH_balance_Q4_Col23_multi_top3frequency_224),
flattenRequest_Q4_Col43_window_count_226,
flattenRequest_Q4_Col83_divide_227,
flattenRequest_Q4_Col83_divide_227 / bo_previous_applicatio_Q4_Col21_multi_unique_count_99,
flattenRequest_Q4_Col157_combine_228,
concat(flattenRequest_Q4_Col157_combine_228,bo_POS_CASH_balance_Q4_Col23_multi_top3frequency_224),
flattenRequest_Q4_Col92_combine_229,
concat(flattenRequest_Q4_Col92_combine_229,bo_POS_CASH_balance_Q4_Col23_multi_top3frequency_224),
flattenRequest_Q4_Col180_combine_231,
Q4_Col40_4,
bo_POS_CASH_balance_Q4_Col199_multi_avg_3,
bo_POS_CASH_balance_Q4_Col199_multi_avg_4,
bo_POS_CASH_balance_Q4_Col200_multi_avg_5,
bo_POS_CASH_balance_Q4_Col199_multi_max_27,
bo_POS_CASH_balance_Q4_Col200_multi_max_28,
bo_POS_CASH_balance_Q4_Col200_multi_min_47,
bo_POS_CASH_balance_Q4_Col3_multi_top3frequency_59,
bo_POS_CASH_balance_Q4_Col21_multi_top3frequency_60,
bo_POS_CASH_balance_Q4_Col22_multi_top3frequency_61,
concat(bo_POS_CASH_balance_Q4_Col22_multi_top3frequency_61,flattenRequest_Q4_Col180_combine_231),
bo_POS_CASH_balance_Q4_Col22_multi_top3frequency_62,
bo_POS_CASH_balance_Q4_Col3_multi_unique_count_75,
bo_POS_CASH_balance_Q4_Col3_multi_unique_count_76,
bo_POS_CASH_balance_Q4_Col1_multi_unique_count_77,
bo_POS_CASH_balance_Q4_Col23_multi_top3frequency_224,
Q4_Col40_7,
bo_bureau_Q4_Col33_multi_avg_6,
bo_bureau_Q4_Col35_multi_avg_7,
bo_bureau_Q4_Col29_multi_avg_8,
bo_bureau_Q4_Col30_multi_avg_9,
bo_bureau_Q4_Col34_multi_max_29,
bo_bureau_Q4_Col36_multi_max_30,
bo_bureau_Q4_Col29_multi_max_31,
bo_bureau_Q4_Col30_multi_max_32,
bo_bureau_Q4_Col30_multi_max_32 / bo_bureau_Q4_Col30_multi_avg_9,
bo_bureau_Q4_Col31_multi_min_48,
bo_bureau_Q4_Col29_multi_min_49,
bo_bureau_Q4_Col30_multi_min_50,
bo_bureau_Q4_Col37_multi_top3frequency_63,
bo_bureau_Q4_Col27_multi_top3frequency_64,
bo_bureau_Q4_Col38_multi_top3frequency_65,
bo_bureau_Q4_Col32_multi_unique_count_78,
bo_bureau_Q4_Col25_multi_unique_count_79,
bo_bureau_Q4_Col26_multi_unique_count_80,
bo_bureau_Q4_Col28_multi_unique_count_81,
bo_bureau_Q4_Col37_multi_unique_count_82,
bo_bureau_Q4_Col27_multi_unique_count_83,
bo_bureau_Q4_Col38_multi_unique_count_84,
Q4_Col40_11,
bo_installment_payment_Q4_Col198_multi_avg_10,
bo_installment_payment_Q4_Col195_multi_avg_11,
bo_installment_payment_Q4_Col193_multi_avg_12,
bo_installment_payment_Q4_Col197_multi_max_33,
bo_installment_payment_Q4_Col197_multi_max_34,
bo_installment_payment_Q4_Col198_multi_max_35,
bo_installment_payment_Q4_Col198_multi_max_36,
bo_installment_payment_Q4_Col193_multi_max_37,
bo_installment_payment_Q4_Col196_multi_min_51,
bo_installment_payment_Q4_Col195_multi_min_52,
bo_installment_payment_Q4_Col194_multi_top3frequency_67,
bo_installment_payment_Q4_Col194_multi_unique_count_91,
bo_installment_payment_Q4_Col1_multi_unique_count_92,
Q4_Col40_14,
bo_part_Q4_Col47_multi_avg_13,
bo_part_Q4_Col86_multi_avg_14,
bo_part_Q4_Col83_multi_avg_15,
bo_part_Q4_Col87_multi_avg_16,
bo_part_Q4_Col45_multi_max_38,
bo_part_Q4_Col82_multi_max_39,
bo_part_Q4_Col84_multi_min_53,
Q4_Col40_18,
bo_previous_applicatio_Q4_Col44_multi_avg_17,
bo_previous_applicatio_Q4_Col45_multi_avg_18,
bo_previous_applicatio_Q4_Col47_multi_avg_19,
bo_previous_applicatio_Q4_Col67_multi_avg_20,
bo_previous_applicatio_Q4_Col70_multi_avg_21,
bo_previous_applicatio_Q4_Col71_multi_avg_22,
bo_previous_applicatio_Q4_Col73_multi_avg_23,
bo_previous_applicatio_Q4_Col74_multi_avg_24,
bo_previous_applicatio_Q4_Col75_multi_avg_25,
bo_previous_applicatio_Q4_Col52_multi_avg_26,
bo_previous_applicatio_Q4_Col39_multi_max_40,
bo_previous_applicatio_Q4_Col44_multi_max_41,
bo_previous_applicatio_Q4_Col45_multi_max_42,
bo_previous_applicatio_Q4_Col46_multi_max_43,
bo_previous_applicatio_Q4_Col47_multi_max_44,
bo_previous_applicatio_Q4_Col72_multi_max_45,
bo_previous_applicatio_Q4_Col52_multi_max_46,
bo_previous_applicatio_Q4_Col45_multi_min_54,
bo_previous_applicatio_Q4_Col47_multi_min_55,
bo_previous_applicatio_Q4_Col67_multi_min_56,
bo_previous_applicatio_Q4_Col74_multi_min_57,
bo_previous_applicatio_Q4_Col52_multi_min_58,
bo_previous_applicatio_Q4_Col64_multi_top3frequency_68,
bo_previous_applicatio_Q4_Col66_multi_top3frequency_69,
bo_previous_applicatio_Q4_Col66_multi_top3frequency_70,
bo_previous_applicatio_Q4_Col59_multi_top3frequency_71,
bo_previous_applicatio_Q4_Col68_multi_top3frequency_72,
bo_previous_applicatio_Q4_Col69_multi_top3frequency_73,
bo_previous_applicatio_Q4_Col65_multi_top3frequency_74,
bo_previous_applicatio_Q4_Col64_multi_unique_count_93,
bo_previous_applicatio_Q4_Col58_multi_unique_count_94,
bo_previous_applicatio_Q4_Col56_multi_unique_count_95,
bo_previous_applicatio_Q4_Col50_multi_unique_count_96,
bo_previous_applicatio_Q4_Col49_multi_unique_count_97,
bo_previous_applicatio_Q4_Col55_multi_unique_count_98,
bo_previous_applicatio_Q4_Col21_multi_unique_count_99,
bo_previous_applicatio_Q4_Col61_multi_unique_count_100,
bo_previous_applicatio_Q4_Col57_multi_unique_count_101,
bo_previous_applicatio_Q4_Col66_multi_unique_count_102,
bo_previous_applicatio_Q4_Col68_multi_unique_count_103,
bo_previous_applicatio_Q4_Col51_multi_unique_count_104,
bo_previous_applicatio_Q4_Col69_multi_unique_count_105,
bo_previous_applicatio_Q4_Col1_multi_unique_count_106,
Q4_Col40_67,
bo_bureau_balance_Q4_Col3_multi_top3frequency_66,
Q4_Col40_86,
bo_credit_card_balance_Q4_Col5_multi_unique_count_85,
bo_credit_card_balance_Q4_Col17_multi_unique_count_86,
bo_credit_card_balance_Q4_Col17_multi_unique_count_87,
bo_credit_card_balance_Q4_Col3_multi_unique_count_88,
bo_credit_card_balance_Q4_Col21_multi_unique_count_89,
bo_credit_card_balance_Q4_Col1_multi_unique_count_90
from 
(
-- train
select
`Q4_Col40` as Q4_Col40_1,
`Q4_Col41` as flattenRequest_Q4_Col41_original_0,
`Q4_Col40` as flattenRequest_Q4_Col40_original_1,
`Q4_Col39` as flattenRequest_Q4_Col39_original_107,
`Q4_Col45` as flattenRequest_Q4_Col45_original_108,
`Q4_Col47` as flattenRequest_Q4_Col47_original_109,
`Q4_Col187` as flattenRequest_Q4_Col187_original_110,
`Q4_Col186` as flattenRequest_Q4_Col186_original_111,
`Q4_Col189` as flattenRequest_Q4_Col189_original_112,
`Q4_Col190` as flattenRequest_Q4_Col190_original_113,
`Q4_Col188` as flattenRequest_Q4_Col188_original_114,
`Q4_Col191` as flattenRequest_Q4_Col191_original_115,
`Q4_Col114` as flattenRequest_Q4_Col114_original_116,
`Q4_Col142` as flattenRequest_Q4_Col142_original_117,
`Q4_Col128` as flattenRequest_Q4_Col128_original_118,
`Q4_Col115` as flattenRequest_Q4_Col115_original_119,
`Q4_Col143` as flattenRequest_Q4_Col143_original_120,
`Q4_Col129` as flattenRequest_Q4_Col129_original_121,
`Q4_Col90` as flattenRequest_Q4_Col90_original_122,
`Q4_Col105` as flattenRequest_Q4_Col105_original_123,
`Q4_Col80` as flattenRequest_Q4_Col80_original_124,
`Q4_Col118` as flattenRequest_Q4_Col118_original_125,
`Q4_Col146` as flattenRequest_Q4_Col146_original_126,
`Q4_Col132` as flattenRequest_Q4_Col132_original_127,
`Q4_Col81` as flattenRequest_Q4_Col81_original_128,
`Q4_Col97` as flattenRequest_Q4_Col97_original_129,
`Q4_Col165` as flattenRequest_Q4_Col165_original_130,
`Q4_Col96` as flattenRequest_Q4_Col96_original_131,
`Q4_Col162` as flattenRequest_Q4_Col162_original_132,
`Q4_Col164` as flattenRequest_Q4_Col164_original_133,
`Q4_Col119` as flattenRequest_Q4_Col119_original_134,
`Q4_Col147` as flattenRequest_Q4_Col147_original_135,
`Q4_Col133` as flattenRequest_Q4_Col133_original_136,
`Q4_Col160` as flattenRequest_Q4_Col160_original_137,
`Q4_Col120` as flattenRequest_Q4_Col120_original_138,
`Q4_Col148` as flattenRequest_Q4_Col148_original_139,
`Q4_Col134` as flattenRequest_Q4_Col134_original_140,
`Q4_Col82` as flattenRequest_Q4_Col82_original_141,
`Q4_Col83` as flattenRequest_Q4_Col83_original_142,
`Q4_Col84` as flattenRequest_Q4_Col84_original_143,
`Q4_Col102` as flattenRequest_Q4_Col102_original_144,
`Q4_Col177` as flattenRequest_Q4_Col177_original_145,
`Q4_Col178` as flattenRequest_Q4_Col178_original_146,
`Q4_Col180` as flattenRequest_Q4_Col180_original_147,
`Q4_Col182` as flattenRequest_Q4_Col182_original_148,
`Q4_Col183` as flattenRequest_Q4_Col183_original_149,
`Q4_Col166` as flattenRequest_Q4_Col166_original_150,
`Q4_Col184` as flattenRequest_Q4_Col184_original_151,
`Q4_Col185` as flattenRequest_Q4_Col185_original_152,
`Q4_Col167` as flattenRequest_Q4_Col167_original_153,
`Q4_Col169` as flattenRequest_Q4_Col169_original_154,
`Q4_Col170` as flattenRequest_Q4_Col170_original_155,
`Q4_Col172` as flattenRequest_Q4_Col172_original_156,
`Q4_Col104` as flattenRequest_Q4_Col104_original_157,
`Q4_Col100` as flattenRequest_Q4_Col100_original_158,
`Q4_Col88` as flattenRequest_Q4_Col88_original_159,
`Q4_Col89` as flattenRequest_Q4_Col89_original_160,
`Q4_Col103` as flattenRequest_Q4_Col103_original_161,
`Q4_Col101` as flattenRequest_Q4_Col101_original_162,
`Q4_Col121` as flattenRequest_Q4_Col121_original_163,
`Q4_Col149` as flattenRequest_Q4_Col149_original_164,
`Q4_Col135` as flattenRequest_Q4_Col135_original_165,
`Q4_Col122` as flattenRequest_Q4_Col122_original_166,
`Q4_Col150` as flattenRequest_Q4_Col150_original_167,
`Q4_Col136` as flattenRequest_Q4_Col136_original_168,
`Q4_Col156` as flattenRequest_Q4_Col156_original_169,
`Q4_Col49` as flattenRequest_Q4_Col49_original_170,
`Q4_Col157` as flattenRequest_Q4_Col157_original_171,
`Q4_Col123` as flattenRequest_Q4_Col123_original_172,
`Q4_Col151` as flattenRequest_Q4_Col151_original_173,
`Q4_Col137` as flattenRequest_Q4_Col137_original_174,
`Q4_Col113` as flattenRequest_Q4_Col113_original_175,
`Q4_Col124` as flattenRequest_Q4_Col124_original_176,
`Q4_Col152` as flattenRequest_Q4_Col152_original_177,
`Q4_Col138` as flattenRequest_Q4_Col138_original_178,
`Q4_Col125` as flattenRequest_Q4_Col125_original_179,
`Q4_Col153` as flattenRequest_Q4_Col153_original_180,
`Q4_Col139` as flattenRequest_Q4_Col139_original_181,
`Q4_Col43` as flattenRequest_Q4_Col43_original_182,
`Q4_Col78` as flattenRequest_Q4_Col78_original_183,
`Q4_Col92` as flattenRequest_Q4_Col92_original_184,
`Q4_Col93` as flattenRequest_Q4_Col93_original_185,
`Q4_Col91` as flattenRequest_Q4_Col91_original_186,
`Q4_Col59` as flattenRequest_Q4_Col59_original_187,
`Q4_Col126` as flattenRequest_Q4_Col126_original_188,
`Q4_Col154` as flattenRequest_Q4_Col154_original_189,
`Q4_Col140` as flattenRequest_Q4_Col140_original_190,
`Q4_Col127` as flattenRequest_Q4_Col127_original_191,
`Q4_Col155` as flattenRequest_Q4_Col155_original_192,
`Q4_Col141` as flattenRequest_Q4_Col141_original_193,
`Q4_Col161` as flattenRequest_Q4_Col161_original_194,
`Q4_Col163` as flattenRequest_Q4_Col163_original_195,
`Q4_Col79` as flattenRequest_Q4_Col79_original_196,
`Q4_Col77` as flattenRequest_Q4_Col77_original_197,
`Q4_Col98` as flattenRequest_Q4_Col98_original_198,
`Q4_Col94` as flattenRequest_Q4_Col94_original_199,
`Q4_Col106` as flattenRequest_Q4_Col106_original_200,
`Q4_Col107` as flattenRequest_Q4_Col107_original_201,
`Q4_Col111` as flattenRequest_Q4_Col111_original_202,
`Q4_Col112` as flattenRequest_Q4_Col112_original_203,
`Q4_Col108` as flattenRequest_Q4_Col108_original_204,
`Q4_Col109` as flattenRequest_Q4_Col109_original_205,
`Q4_Col158` as flattenRequest_Q4_Col158_original_206,
`Q4_Col159` as flattenRequest_Q4_Col159_original_207,
`Q4_Col48` as flattenRequest_Q4_Col48_original_208,
`Q4_Col116` as flattenRequest_Q4_Col116_original_209,
`Q4_Col144` as flattenRequest_Q4_Col144_original_210,
`Q4_Col130` as flattenRequest_Q4_Col130_original_211,
`Q4_Col117` as flattenRequest_Q4_Col117_original_212,
`Q4_Col145` as flattenRequest_Q4_Col145_original_213,
`Q4_Col131` as flattenRequest_Q4_Col131_original_214,
`Q4_Col45` as flattenRequest_Q4_Col45_divide_215,
`Q4_Col39` as flattenRequest_Q4_Col39_divide_215,
`Q4_Col39` as flattenRequest_Q4_Col39_divide_216,
`Q4_Col45` as flattenRequest_Q4_Col45_divide_216,
`Q4_Col47` as flattenRequest_Q4_Col47_divide_217,
`Q4_Col39` as flattenRequest_Q4_Col39_divide_217,
`Q4_Col39` as flattenRequest_Q4_Col39_divide_218,
`Q4_Col47` as flattenRequest_Q4_Col47_divide_218,
`Q4_Col83` as flattenRequest_Q4_Col83_multiply_219,
`Q4_Col84` as flattenRequest_Q4_Col84_multiply_219,
`Q4_Col47` as flattenRequest_Q4_Col47_divide_220,
`Q4_Col47` as flattenRequest_Q4_Col47_divide_221,
`Q4_Col45` as flattenRequest_Q4_Col45_divide_221,
`Q4_Col80` as flattenRequest_Q4_Col80_combine_222,
`Q4_Col92` as flattenRequest_Q4_Col92_combine_222,
`Q4_Col45` as flattenRequest_Q4_Col45_divide_223,
`Q4_Col47` as flattenRequest_Q4_Col47_divide_223,
`Q4_Col159` as flattenRequest_Q4_Col159_combine_224,
`Q4_Col160` as flattenRequest_Q4_Col160_combine_225,
case when !isnull(at(`Q4_Col43`, 0)) over flattenRequest_Q4_Col78_Q4_Col41_0s_10h_100 then count_where(`Q4_Col43`, `Q4_Col43` = at(`Q4_Col43`, 0)) over flattenRequest_Q4_Col78_Q4_Col41_0s_10h_100 else null end as flattenRequest_Q4_Col43_window_count_226,
`Q4_Col83` as flattenRequest_Q4_Col83_divide_227,
`Q4_Col157` as flattenRequest_Q4_Col157_combine_228,
`Q4_Col92` as flattenRequest_Q4_Col92_combine_229,
`Q4_Col180` as flattenRequest_Q4_Col180_combine_231
from
`train`
window flattenRequest_Q4_Col78_Q4_Col41_0s_10h_100 as (partition by `Q4_Col78` order by `Q4_Col41` rows_range between 10h preceding and 0s preceding MAXSIZE 100))
as out0
last join
(
select
`train`.`Q4_Col40` as Q4_Col40_3,
`action_Q4_Col40`.`Q4_Col42` as action_Q4_Col42_multi_direct_2
from
`train`
last join `action` as `action_Q4_Col40` on `train`.`Q4_Col40` = `action_Q4_Col40`.`Q4_Col40`)
as out1
on out0.Q4_Col40_1 = out1.Q4_Col40_3
last join
(
select
`Q4_Col2` as Q4_Col40_4,
avg(`Q4_Col199`) over bo_POS_CASH_balance_Q4_Col2_Q4_Col0_0_100_ as bo_POS_CASH_balance_Q4_Col199_multi_avg_3,
avg(`Q4_Col199`) over bo_POS_CASH_balance_Q4_Col2_Q4_Col0_0_10_ as bo_POS_CASH_balance_Q4_Col199_multi_avg_4,
avg(`Q4_Col200`) over bo_POS_CASH_balance_Q4_Col2_Q4_Col0_0_10_ as bo_POS_CASH_balance_Q4_Col200_multi_avg_5,
max(`Q4_Col199`) over bo_POS_CASH_balance_Q4_Col2_Q4_Col0_0_100_ as bo_POS_CASH_balance_Q4_Col199_multi_max_27,
max(`Q4_Col200`) over bo_POS_CASH_balance_Q4_Col2_Q4_Col0_0_100_ as bo_POS_CASH_balance_Q4_Col200_multi_max_28,
min(`Q4_Col200`) over bo_POS_CASH_balance_Q4_Col2_Q4_Col0_0_10_ as bo_POS_CASH_balance_Q4_Col200_multi_min_47,
topn_frequency(`Q4_Col3`, 3) over bo_POS_CASH_balance_Q4_Col2_Q4_Col0_0_100_ as bo_POS_CASH_balance_Q4_Col3_multi_top3frequency_59,
topn_frequency(`Q4_Col21`, 3) over bo_POS_CASH_balance_Q4_Col2_Q4_Col0_0_100_ as bo_POS_CASH_balance_Q4_Col21_multi_top3frequency_60,
topn_frequency(`Q4_Col22`, 3) over bo_POS_CASH_balance_Q4_Col2_Q4_Col0_0_100_ as bo_POS_CASH_balance_Q4_Col22_multi_top3frequency_61,
topn_frequency(`Q4_Col22`, 3) over bo_POS_CASH_balance_Q4_Col2_Q4_Col0_0_10_ as bo_POS_CASH_balance_Q4_Col22_multi_top3frequency_62,
distinct_count(`Q4_Col3`) over bo_POS_CASH_balance_Q4_Col2_Q4_Col0_0_100_ as bo_POS_CASH_balance_Q4_Col3_multi_unique_count_75,
distinct_count(`Q4_Col3`) over bo_POS_CASH_balance_Q4_Col2_Q4_Col0_0_10_ as bo_POS_CASH_balance_Q4_Col3_multi_unique_count_76,
distinct_count(`Q4_Col1`) over bo_POS_CASH_balance_Q4_Col2_Q4_Col0_0_100_ as bo_POS_CASH_balance_Q4_Col1_multi_unique_count_77,
topn_frequency(`Q4_Col23`, 3) over bo_POS_CASH_balance_Q4_Col2_Q4_Col0_0_100_ as bo_POS_CASH_balance_Q4_Col23_multi_top3frequency_224
from
(select `Q4_Col41` as `Q4_Col0`, bigint(0) as `Q4_Col1`, `Q4_Col40` as `Q4_Col2`, bigint(0) as `Q4_Col3`, double(0) as `Q4_Col199`, double(0) as `Q4_Col200`, '' as `Q4_Col21`, bigint(0) as `Q4_Col22`, bigint(0) as `Q4_Col23` from `train`)
window bo_POS_CASH_balance_Q4_Col2_Q4_Col0_0_100_ as (
UNION `bo_POS_CASH_balance` partition by `Q4_Col2` order by `Q4_Col0` rows between 100 preceding and 0 preceding INSTANCE_NOT_IN_WINDOW),
bo_POS_CASH_balance_Q4_Col2_Q4_Col0_0_10_ as (
UNION `bo_POS_CASH_balance` partition by `Q4_Col2` order by `Q4_Col0` rows between 10 preceding and 0 preceding INSTANCE_NOT_IN_WINDOW))
as out2
on out0.Q4_Col40_1 = out2.Q4_Col40_4
last join
(
select
`Q4_Col2` as Q4_Col40_7,
avg(`Q4_Col33`) over bo_bureau_Q4_Col2_Q4_Col0_0_100_ as bo_bureau_Q4_Col33_multi_avg_6,
avg(`Q4_Col35`) over bo_bureau_Q4_Col2_Q4_Col0_0_100_ as bo_bureau_Q4_Col35_multi_avg_7,
avg(`Q4_Col29`) over bo_bureau_Q4_Col2_Q4_Col0_0_10_ as bo_bureau_Q4_Col29_multi_avg_8,
avg(`Q4_Col30`) over bo_bureau_Q4_Col2_Q4_Col0_0_10_ as bo_bureau_Q4_Col30_multi_avg_9,
max(`Q4_Col34`) over bo_bureau_Q4_Col2_Q4_Col0_0_100_ as bo_bureau_Q4_Col34_multi_max_29,
max(`Q4_Col36`) over bo_bureau_Q4_Col2_Q4_Col0_0_100_ as bo_bureau_Q4_Col36_multi_max_30,
max(`Q4_Col29`) over bo_bureau_Q4_Col2_Q4_Col0_0_10_ as bo_bureau_Q4_Col29_multi_max_31,
max(`Q4_Col30`) over bo_bureau_Q4_Col2_Q4_Col0_0_10_ as bo_bureau_Q4_Col30_multi_max_32,
min(`Q4_Col31`) over bo_bureau_Q4_Col2_Q4_Col0_0_10_ as bo_bureau_Q4_Col31_multi_min_48,
min(`Q4_Col29`) over bo_bureau_Q4_Col2_Q4_Col0_0_10_ as bo_bureau_Q4_Col29_multi_min_49,
min(`Q4_Col30`) over bo_bureau_Q4_Col2_Q4_Col0_0_10_ as bo_bureau_Q4_Col30_multi_min_50,
topn_frequency(`Q4_Col37`, 3) over bo_bureau_Q4_Col2_Q4_Col0_0_100_ as bo_bureau_Q4_Col37_multi_top3frequency_63,
topn_frequency(`Q4_Col27`, 3) over bo_bureau_Q4_Col2_Q4_Col0_0_10_ as bo_bureau_Q4_Col27_multi_top3frequency_64,
topn_frequency(`Q4_Col38`, 3) over bo_bureau_Q4_Col2_Q4_Col0_0_10_ as bo_bureau_Q4_Col38_multi_top3frequency_65,
distinct_count(`Q4_Col32`) over bo_bureau_Q4_Col2_Q4_Col0_0_100_ as bo_bureau_Q4_Col32_multi_unique_count_78,
distinct_count(`Q4_Col25`) over bo_bureau_Q4_Col2_Q4_Col0_0_100_ as bo_bureau_Q4_Col25_multi_unique_count_79,
distinct_count(`Q4_Col26`) over bo_bureau_Q4_Col2_Q4_Col0_0_100_ as bo_bureau_Q4_Col26_multi_unique_count_80,
distinct_count(`Q4_Col28`) over bo_bureau_Q4_Col2_Q4_Col0_0_100_ as bo_bureau_Q4_Col28_multi_unique_count_81,
distinct_count(`Q4_Col37`) over bo_bureau_Q4_Col2_Q4_Col0_0_10_ as bo_bureau_Q4_Col37_multi_unique_count_82,
distinct_count(`Q4_Col27`) over bo_bureau_Q4_Col2_Q4_Col0_0_10_ as bo_bureau_Q4_Col27_multi_unique_count_83,
distinct_count(`Q4_Col38`) over bo_bureau_Q4_Col2_Q4_Col0_0_100_ as bo_bureau_Q4_Col38_multi_unique_count_84
from
(select `Q4_Col41` as `Q4_Col0`, `Q4_Col40` as `Q4_Col2`, bigint(0) as `Q4_Col24`, '' as `Q4_Col25`, '' as `Q4_Col26`, bigint(0) as `Q4_Col27`, bigint(0) as `Q4_Col28`, double(0) as `Q4_Col29`, double(0) as `Q4_Col30`, double(0) as `Q4_Col31`, bigint(0) as `Q4_Col32`, double(0) as `Q4_Col33`, double(0) as `Q4_Col34`, double(0) as `Q4_Col35`, double(0) as `Q4_Col36`, '' as `Q4_Col37`, bigint(0) as `Q4_Col38`, double(0) as `Q4_Col39` from `train`)
window bo_bureau_Q4_Col2_Q4_Col0_0_100_ as (
UNION `bo_bureau` partition by `Q4_Col2` order by `Q4_Col0` rows between 100 preceding and 0 preceding INSTANCE_NOT_IN_WINDOW),
bo_bureau_Q4_Col2_Q4_Col0_0_10_ as (
UNION `bo_bureau` partition by `Q4_Col2` order by `Q4_Col0` rows between 10 preceding and 0 preceding INSTANCE_NOT_IN_WINDOW))
as out3
on out0.Q4_Col40_1 = out3.Q4_Col40_7
last join
(
select
`Q4_Col2` as Q4_Col40_11,
avg(`Q4_Col198`) over bo_installment_payment_Q4_Col2_Q4_Col0_0_10_ as bo_installment_payment_Q4_Col198_multi_avg_10,
avg(`Q4_Col195`) over bo_installment_payment_Q4_Col2_Q4_Col0_0_100_ as bo_installment_payment_Q4_Col195_multi_avg_11,
avg(`Q4_Col193`) over bo_installment_payment_Q4_Col2_Q4_Col0_0_10_ as bo_installment_payment_Q4_Col193_multi_avg_12,
max(`Q4_Col197`) over bo_installment_payment_Q4_Col2_Q4_Col0_0_100_ as bo_installment_payment_Q4_Col197_multi_max_33,
max(`Q4_Col197`) over bo_installment_payment_Q4_Col2_Q4_Col0_0_10_ as bo_installment_payment_Q4_Col197_multi_max_34,
max(`Q4_Col198`) over bo_installment_payment_Q4_Col2_Q4_Col0_0_100_ as bo_installment_payment_Q4_Col198_multi_max_35,
max(`Q4_Col198`) over bo_installment_payment_Q4_Col2_Q4_Col0_0_10_ as bo_installment_payment_Q4_Col198_multi_max_36,
max(`Q4_Col193`) over bo_installment_payment_Q4_Col2_Q4_Col0_0_10_ as bo_installment_payment_Q4_Col193_multi_max_37,
min(`Q4_Col196`) over bo_installment_payment_Q4_Col2_Q4_Col0_0_100_ as bo_installment_payment_Q4_Col196_multi_min_51,
min(`Q4_Col195`) over bo_installment_payment_Q4_Col2_Q4_Col0_0_10_ as bo_installment_payment_Q4_Col195_multi_min_52,
topn_frequency(`Q4_Col194`, 3) over bo_installment_payment_Q4_Col2_Q4_Col0_0_10_ as bo_installment_payment_Q4_Col194_multi_top3frequency_67,
distinct_count(`Q4_Col194`) over bo_installment_payment_Q4_Col2_Q4_Col0_0_100_ as bo_installment_payment_Q4_Col194_multi_unique_count_91,
distinct_count(`Q4_Col1`) over bo_installment_payment_Q4_Col2_Q4_Col0_0_10_ as bo_installment_payment_Q4_Col1_multi_unique_count_92
from
(select `Q4_Col41` as `Q4_Col0`, bigint(0) as `Q4_Col1`, `Q4_Col40` as `Q4_Col2`, double(0) as `Q4_Col193`, bigint(0) as `Q4_Col194`, double(0) as `Q4_Col195`, double(0) as `Q4_Col196`, double(0) as `Q4_Col197`, double(0) as `Q4_Col198` from `train`)
window bo_installment_payment_Q4_Col2_Q4_Col0_0_10_ as (
UNION `bo_installment_payment` partition by `Q4_Col2` order by `Q4_Col0` rows between 10 preceding and 0 preceding INSTANCE_NOT_IN_WINDOW),
bo_installment_payment_Q4_Col2_Q4_Col0_0_100_ as (
UNION `bo_installment_payment` partition by `Q4_Col2` order by `Q4_Col0` rows between 100 preceding and 0 preceding INSTANCE_NOT_IN_WINDOW))
as out4
on out0.Q4_Col40_1 = out4.Q4_Col40_11
last join
(
select
`Q4_Col40` as Q4_Col40_14,
avg(`Q4_Col47`) over bo_part_Q4_Col77_Q4_Col78_Q4_Col79_Q4_Col80_Q4_Col81_Q4_Col0_0_10_ as bo_part_Q4_Col47_multi_avg_13,
avg(`Q4_Col86`) over bo_part_Q4_Col77_Q4_Col78_Q4_Col79_Q4_Col80_Q4_Col81_Q4_Col0_0_10_ as bo_part_Q4_Col86_multi_avg_14,
avg(`Q4_Col83`) over bo_part_Q4_Col77_Q4_Col78_Q4_Col79_Q4_Col80_Q4_Col81_Q4_Col0_0_10_ as bo_part_Q4_Col83_multi_avg_15,
avg(`Q4_Col87`) over bo_part_Q4_Col77_Q4_Col78_Q4_Col79_Q4_Col80_Q4_Col81_Q4_Col0_0_10_ as bo_part_Q4_Col87_multi_avg_16,
max(`Q4_Col45`) over bo_part_Q4_Col77_Q4_Col78_Q4_Col79_Q4_Col80_Q4_Col81_Q4_Col0_0_10_ as bo_part_Q4_Col45_multi_max_38,
max(`Q4_Col82`) over bo_part_Q4_Col77_Q4_Col78_Q4_Col79_Q4_Col80_Q4_Col81_Q4_Col0_0_10_ as bo_part_Q4_Col82_multi_max_39,
min(`Q4_Col84`) over bo_part_Q4_Col77_Q4_Col78_Q4_Col79_Q4_Col80_Q4_Col81_Q4_Col0_0_10_ as bo_part_Q4_Col84_multi_min_53
from
(select `Q4_Col41` as `Q4_Col0`, `Q4_Col77` as `Q4_Col77`, `Q4_Col78` as `Q4_Col78`, `Q4_Col79` as `Q4_Col79`, `Q4_Col80` as `Q4_Col80`, `Q4_Col81` as `Q4_Col81`, double(0) as `Q4_Col82`, double(0) as `Q4_Col83`, double(0) as `Q4_Col84`, double(0) as `Q4_Col85`, double(0) as `Q4_Col45`, double(0) as `Q4_Col39`, double(0) as `Q4_Col47`, double(0) as `Q4_Col86`, double(0) as `Q4_Col87`, Q4_Col40 from `train`)
window bo_part_Q4_Col77_Q4_Col78_Q4_Col79_Q4_Col80_Q4_Col81_Q4_Col0_0_10_ as (
UNION (select `Q4_Col0`, `Q4_Col77`, `Q4_Col78`, `Q4_Col79`, `Q4_Col80`, `Q4_Col81`, `Q4_Col82`, `Q4_Col83`, `Q4_Col84`, `Q4_Col85`, `Q4_Col45`, `Q4_Col39`, `Q4_Col47`, `Q4_Col86`, `Q4_Col87`, '' as Q4_Col40 from `bo_part`) partition by `Q4_Col77`,`Q4_Col78`,`Q4_Col79`,`Q4_Col80`,`Q4_Col81` order by `Q4_Col0` rows between 10 preceding and 0 preceding INSTANCE_NOT_IN_WINDOW))
as out5
on out0.Q4_Col40_1 = out5.Q4_Col40_14
last join
(
select
`Q4_Col2` as Q4_Col40_18,
avg(`Q4_Col44`) over bo_previous_applicatio_Q4_Col2_Q4_Col0_0_10_ as bo_previous_applicatio_Q4_Col44_multi_avg_17,
avg(`Q4_Col45`) over bo_previous_applicatio_Q4_Col2_Q4_Col0_0_10_ as bo_previous_applicatio_Q4_Col45_multi_avg_18,
avg(`Q4_Col47`) over bo_previous_applicatio_Q4_Col2_Q4_Col0_0_100_ as bo_previous_applicatio_Q4_Col47_multi_avg_19,
avg(`Q4_Col67`) over bo_previous_applicatio_Q4_Col2_Q4_Col0_0_100_ as bo_previous_applicatio_Q4_Col67_multi_avg_20,
avg(`Q4_Col70`) over bo_previous_applicatio_Q4_Col2_Q4_Col0_0_100_ as bo_previous_applicatio_Q4_Col70_multi_avg_21,
avg(`Q4_Col71`) over bo_previous_applicatio_Q4_Col2_Q4_Col0_0_10_ as bo_previous_applicatio_Q4_Col71_multi_avg_22,
avg(`Q4_Col73`) over bo_previous_applicatio_Q4_Col2_Q4_Col0_0_10_ as bo_previous_applicatio_Q4_Col73_multi_avg_23,
avg(`Q4_Col74`) over bo_previous_applicatio_Q4_Col2_Q4_Col0_0_100_ as bo_previous_applicatio_Q4_Col74_multi_avg_24,
avg(`Q4_Col75`) over bo_previous_applicatio_Q4_Col2_Q4_Col0_0_10_ as bo_previous_applicatio_Q4_Col75_multi_avg_25,
avg(`Q4_Col52`) over bo_previous_applicatio_Q4_Col2_Q4_Col0_0_10_ as bo_previous_applicatio_Q4_Col52_multi_avg_26,
max(`Q4_Col39`) over bo_previous_applicatio_Q4_Col2_Q4_Col0_0_100_ as bo_previous_applicatio_Q4_Col39_multi_max_40,
max(`Q4_Col44`) over bo_previous_applicatio_Q4_Col2_Q4_Col0_0_100_ as bo_previous_applicatio_Q4_Col44_multi_max_41,
max(`Q4_Col45`) over bo_previous_applicatio_Q4_Col2_Q4_Col0_0_100_ as bo_previous_applicatio_Q4_Col45_multi_max_42,
max(`Q4_Col46`) over bo_previous_applicatio_Q4_Col2_Q4_Col0_0_100_ as bo_previous_applicatio_Q4_Col46_multi_max_43,
max(`Q4_Col47`) over bo_previous_applicatio_Q4_Col2_Q4_Col0_0_100_ as bo_previous_applicatio_Q4_Col47_multi_max_44,
max(`Q4_Col72`) over bo_previous_applicatio_Q4_Col2_Q4_Col0_0_100_ as bo_previous_applicatio_Q4_Col72_multi_max_45,
max(`Q4_Col52`) over bo_previous_applicatio_Q4_Col2_Q4_Col0_0_10_ as bo_previous_applicatio_Q4_Col52_multi_max_46,
min(`Q4_Col45`) over bo_previous_applicatio_Q4_Col2_Q4_Col0_0_100_ as bo_previous_applicatio_Q4_Col45_multi_min_54,
min(`Q4_Col47`) over bo_previous_applicatio_Q4_Col2_Q4_Col0_0_100_ as bo_previous_applicatio_Q4_Col47_multi_min_55,
min(`Q4_Col67`) over bo_previous_applicatio_Q4_Col2_Q4_Col0_0_100_ as bo_previous_applicatio_Q4_Col67_multi_min_56,
min(`Q4_Col74`) over bo_previous_applicatio_Q4_Col2_Q4_Col0_0_10_ as bo_previous_applicatio_Q4_Col74_multi_min_57,
min(`Q4_Col52`) over bo_previous_applicatio_Q4_Col2_Q4_Col0_0_10_ as bo_previous_applicatio_Q4_Col52_multi_min_58,
topn_frequency(`Q4_Col64`, 3) over bo_previous_applicatio_Q4_Col2_Q4_Col0_0_100_ as bo_previous_applicatio_Q4_Col64_multi_top3frequency_68,
topn_frequency(`Q4_Col66`, 3) over bo_previous_applicatio_Q4_Col2_Q4_Col0_0_100_ as bo_previous_applicatio_Q4_Col66_multi_top3frequency_69,
topn_frequency(`Q4_Col66`, 3) over bo_previous_applicatio_Q4_Col2_Q4_Col0_0_10_ as bo_previous_applicatio_Q4_Col66_multi_top3frequency_70,
topn_frequency(`Q4_Col59`, 3) over bo_previous_applicatio_Q4_Col2_Q4_Col0_0_10_ as bo_previous_applicatio_Q4_Col59_multi_top3frequency_71,
topn_frequency(`Q4_Col68`, 3) over bo_previous_applicatio_Q4_Col2_Q4_Col0_0_10_ as bo_previous_applicatio_Q4_Col68_multi_top3frequency_72,
topn_frequency(`Q4_Col69`, 3) over bo_previous_applicatio_Q4_Col2_Q4_Col0_0_10_ as bo_previous_applicatio_Q4_Col69_multi_top3frequency_73,
topn_frequency(`Q4_Col65`, 3) over bo_previous_applicatio_Q4_Col2_Q4_Col0_0_10_ as bo_previous_applicatio_Q4_Col65_multi_top3frequency_74,
distinct_count(`Q4_Col64`) over bo_previous_applicatio_Q4_Col2_Q4_Col0_0_100_ as bo_previous_applicatio_Q4_Col64_multi_unique_count_93,
distinct_count(`Q4_Col58`) over bo_previous_applicatio_Q4_Col2_Q4_Col0_0_100_ as bo_previous_applicatio_Q4_Col58_multi_unique_count_94,
distinct_count(`Q4_Col56`) over bo_previous_applicatio_Q4_Col2_Q4_Col0_0_100_ as bo_previous_applicatio_Q4_Col56_multi_unique_count_95,
distinct_count(`Q4_Col50`) over bo_previous_applicatio_Q4_Col2_Q4_Col0_0_100_ as bo_previous_applicatio_Q4_Col50_multi_unique_count_96,
distinct_count(`Q4_Col49`) over bo_previous_applicatio_Q4_Col2_Q4_Col0_0_10_ as bo_previous_applicatio_Q4_Col49_multi_unique_count_97,
distinct_count(`Q4_Col55`) over bo_previous_applicatio_Q4_Col2_Q4_Col0_0_10_ as bo_previous_applicatio_Q4_Col55_multi_unique_count_98,
distinct_count(`Q4_Col21`) over bo_previous_applicatio_Q4_Col2_Q4_Col0_0_100_ as bo_previous_applicatio_Q4_Col21_multi_unique_count_99,
distinct_count(`Q4_Col61`) over bo_previous_applicatio_Q4_Col2_Q4_Col0_0_10_ as bo_previous_applicatio_Q4_Col61_multi_unique_count_100,
distinct_count(`Q4_Col57`) over bo_previous_applicatio_Q4_Col2_Q4_Col0_0_10_ as bo_previous_applicatio_Q4_Col57_multi_unique_count_101,
distinct_count(`Q4_Col66`) over bo_previous_applicatio_Q4_Col2_Q4_Col0_0_10_ as bo_previous_applicatio_Q4_Col66_multi_unique_count_102,
distinct_count(`Q4_Col68`) over bo_previous_applicatio_Q4_Col2_Q4_Col0_0_10_ as bo_previous_applicatio_Q4_Col68_multi_unique_count_103,
distinct_count(`Q4_Col51`) over bo_previous_applicatio_Q4_Col2_Q4_Col0_0_10_ as bo_previous_applicatio_Q4_Col51_multi_unique_count_104,
distinct_count(`Q4_Col69`) over bo_previous_applicatio_Q4_Col2_Q4_Col0_0_100_ as bo_previous_applicatio_Q4_Col69_multi_unique_count_105,
distinct_count(`Q4_Col1`) over bo_previous_applicatio_Q4_Col2_Q4_Col0_0_100_ as bo_previous_applicatio_Q4_Col1_multi_unique_count_106
from
(select `Q4_Col41` as `Q4_Col0`, bigint(0) as `Q4_Col1`, `Q4_Col40` as `Q4_Col2`, '' as `Q4_Col43`, double(0) as `Q4_Col39`, double(0) as `Q4_Col44`, double(0) as `Q4_Col45`, double(0) as `Q4_Col46`, double(0) as `Q4_Col47`, '' as `Q4_Col48`, bigint(0) as `Q4_Col49`, '' as `Q4_Col50`, bigint(0) as `Q4_Col51`, double(0) as `Q4_Col52`, double(0) as `Q4_Col53`, double(0) as `Q4_Col54`, '' as `Q4_Col55`, '' as `Q4_Col21`, bigint(0) as `Q4_Col56`, '' as `Q4_Col57`, '' as `Q4_Col58`, '' as `Q4_Col59`, '' as `Q4_Col60`, '' as `Q4_Col61`, '' as `Q4_Col62`, '' as `Q4_Col63`, '' as `Q4_Col64`, bigint(0) as `Q4_Col65`, '' as `Q4_Col66`, double(0) as `Q4_Col67`, '' as `Q4_Col68`, '' as `Q4_Col69`, double(0) as `Q4_Col70`, double(0) as `Q4_Col71`, double(0) as `Q4_Col72`, double(0) as `Q4_Col73`, double(0) as `Q4_Col74`, double(0) as `Q4_Col75` from `train`)
window bo_previous_applicatio_Q4_Col2_Q4_Col0_0_10_ as (
UNION `bo_previous_applicatio` partition by `Q4_Col2` order by `Q4_Col0` rows between 10 preceding and 0 preceding INSTANCE_NOT_IN_WINDOW),
bo_previous_applicatio_Q4_Col2_Q4_Col0_0_100_ as (
UNION `bo_previous_applicatio` partition by `Q4_Col2` order by `Q4_Col0` rows between 100 preceding and 0 preceding INSTANCE_NOT_IN_WINDOW))
as out6
on out0.Q4_Col40_1 = out6.Q4_Col40_18
last join
(
select
`Q4_Col2` as Q4_Col40_67,
topn_frequency(`Q4_Col3`, 3) over bo_bureau_balance_Q4_Col2_Q4_Col0_0_10_ as bo_bureau_balance_Q4_Col3_multi_top3frequency_66
from
(select `Q4_Col41` as `Q4_Col0`, bigint(0) as `Q4_Col24`, bigint(0) as `Q4_Col3`, '' as `Q4_Col76`, `Q4_Col40` as `Q4_Col2` from `train`)
window bo_bureau_balance_Q4_Col2_Q4_Col0_0_10_ as (
UNION `bo_bureau_balance` partition by `Q4_Col2` order by `Q4_Col0` rows between 10 preceding and 0 preceding INSTANCE_NOT_IN_WINDOW))
as out7
on out0.Q4_Col40_1 = out7.Q4_Col40_67
last join
(
select
`Q4_Col2` as Q4_Col40_86,
distinct_count(`Q4_Col5`) over bo_credit_card_balance_Q4_Col2_Q4_Col0_0_10_ as bo_credit_card_balance_Q4_Col5_multi_unique_count_85,
distinct_count(`Q4_Col17`) over bo_credit_card_balance_Q4_Col2_Q4_Col0_0_100_ as bo_credit_card_balance_Q4_Col17_multi_unique_count_86,
distinct_count(`Q4_Col17`) over bo_credit_card_balance_Q4_Col2_Q4_Col0_0_10_ as bo_credit_card_balance_Q4_Col17_multi_unique_count_87,
distinct_count(`Q4_Col3`) over bo_credit_card_balance_Q4_Col2_Q4_Col0_0_100_ as bo_credit_card_balance_Q4_Col3_multi_unique_count_88,
distinct_count(`Q4_Col21`) over bo_credit_card_balance_Q4_Col2_Q4_Col0_0_100_ as bo_credit_card_balance_Q4_Col21_multi_unique_count_89,
distinct_count(`Q4_Col1`) over bo_credit_card_balance_Q4_Col2_Q4_Col0_0_10_ as bo_credit_card_balance_Q4_Col1_multi_unique_count_90
from
(select `Q4_Col41` as `Q4_Col0`, bigint(0) as `Q4_Col1`, `Q4_Col40` as `Q4_Col2`, bigint(0) as `Q4_Col3`, double(0) as `Q4_Col4`, bigint(0) as `Q4_Col5`, double(0) as `Q4_Col6`, double(0) as `Q4_Col7`, double(0) as `Q4_Col8`, double(0) as `Q4_Col9`, double(0) as `Q4_Col10`, double(0) as `Q4_Col11`, double(0) as `Q4_Col12`, double(0) as `Q4_Col13`, double(0) as `Q4_Col14`, double(0) as `Q4_Col15`, double(0) as `Q4_Col16`, bigint(0) as `Q4_Col17`, double(0) as `Q4_Col18`, double(0) as `Q4_Col19`, double(0) as `Q4_Col20`, '' as `Q4_Col21`, bigint(0) as `Q4_Col22`, bigint(0) as `Q4_Col23` from `train`)
window bo_credit_card_balance_Q4_Col2_Q4_Col0_0_10_ as (
UNION `bo_credit_card_balance` partition by `Q4_Col2` order by `Q4_Col0` rows between 10 preceding and 0 preceding INSTANCE_NOT_IN_WINDOW),
bo_credit_card_balance_Q4_Col2_Q4_Col0_0_100_ as (
UNION `bo_credit_card_balance` partition by `Q4_Col2` order by `Q4_Col0` rows between 100 preceding and 0 preceding INSTANCE_NOT_IN_WINDOW))
as out8
on out0.Q4_Col40_1 = out8.Q4_Col40_86
;
