key_flattenRequest_Q4_Col40_1 = window(table=flattenRequest, output="flattenRequest_output")
flattenRequest_outputkey_flattenRequest_Q4_Col40 = output(key_flattenRequest_Q4_Col40_1.Q4_Col40[0])
f_original_Q4_Col41_0 = column(key_flattenRequest_Q4_Col40_1.Q4_Col41[0])
f_original_Q4_Col40_1 = column(key_flattenRequest_Q4_Col40_1.Q4_Col40[0])
f_original_Q4_Col39_107 = column(key_flattenRequest_Q4_Col40_1.Q4_Col39[0])
f_original_Q4_Col45_108 = column(key_flattenRequest_Q4_Col40_1.Q4_Col45[0])
f_original_Q4_Col47_109 = column(key_flattenRequest_Q4_Col40_1.Q4_Col47[0])
f_original_Q4_Col187_110 = column(key_flattenRequest_Q4_Col40_1.Q4_Col187[0])
f_original_Q4_Col186_111 = column(key_flattenRequest_Q4_Col40_1.Q4_Col186[0])
f_original_Q4_Col189_112 = column(key_flattenRequest_Q4_Col40_1.Q4_Col189[0])
f_original_Q4_Col190_113 = column(key_flattenRequest_Q4_Col40_1.Q4_Col190[0])
f_original_Q4_Col188_114 = column(key_flattenRequest_Q4_Col40_1.Q4_Col188[0])
f_original_Q4_Col191_115 = column(key_flattenRequest_Q4_Col40_1.Q4_Col191[0])
f_original_Q4_Col114_116 = column(key_flattenRequest_Q4_Col40_1.Q4_Col114[0])
f_original_Q4_Col142_117 = column(key_flattenRequest_Q4_Col40_1.Q4_Col142[0])
f_original_Q4_Col128_118 = column(key_flattenRequest_Q4_Col40_1.Q4_Col128[0])
f_original_Q4_Col115_119 = column(key_flattenRequest_Q4_Col40_1.Q4_Col115[0])
f_original_Q4_Col143_120 = column(key_flattenRequest_Q4_Col40_1.Q4_Col143[0])
f_original_Q4_Col129_121 = column(key_flattenRequest_Q4_Col40_1.Q4_Col129[0])
f_original_Q4_Col90_122 = column(key_flattenRequest_Q4_Col40_1.Q4_Col90[0])
f_original_Q4_Col105_123 = column(key_flattenRequest_Q4_Col40_1.Q4_Col105[0])
f_original_Q4_Col80_124 = column(key_flattenRequest_Q4_Col40_1.Q4_Col80[0])
f_original_Q4_Col118_125 = column(key_flattenRequest_Q4_Col40_1.Q4_Col118[0])
f_original_Q4_Col146_126 = column(key_flattenRequest_Q4_Col40_1.Q4_Col146[0])
f_original_Q4_Col132_127 = column(key_flattenRequest_Q4_Col40_1.Q4_Col132[0])
f_original_Q4_Col81_128 = column(key_flattenRequest_Q4_Col40_1.Q4_Col81[0])
f_original_Q4_Col97_129 = column(key_flattenRequest_Q4_Col40_1.Q4_Col97[0])
f_original_Q4_Col165_130 = column(key_flattenRequest_Q4_Col40_1.Q4_Col165[0])
f_original_Q4_Col96_131 = column(key_flattenRequest_Q4_Col40_1.Q4_Col96[0])
f_original_Q4_Col162_132 = column(key_flattenRequest_Q4_Col40_1.Q4_Col162[0])
f_original_Q4_Col164_133 = column(key_flattenRequest_Q4_Col40_1.Q4_Col164[0])
f_original_Q4_Col119_134 = column(key_flattenRequest_Q4_Col40_1.Q4_Col119[0])
f_original_Q4_Col147_135 = column(key_flattenRequest_Q4_Col40_1.Q4_Col147[0])
f_original_Q4_Col133_136 = column(key_flattenRequest_Q4_Col40_1.Q4_Col133[0])
f_original_Q4_Col160_137 = column(key_flattenRequest_Q4_Col40_1.Q4_Col160[0])
f_original_Q4_Col120_138 = column(key_flattenRequest_Q4_Col40_1.Q4_Col120[0])
f_original_Q4_Col148_139 = column(key_flattenRequest_Q4_Col40_1.Q4_Col148[0])
f_original_Q4_Col134_140 = column(key_flattenRequest_Q4_Col40_1.Q4_Col134[0])
f_original_Q4_Col82_141 = column(key_flattenRequest_Q4_Col40_1.Q4_Col82[0])
f_original_Q4_Col83_142 = column(key_flattenRequest_Q4_Col40_1.Q4_Col83[0])
f_original_Q4_Col84_143 = column(key_flattenRequest_Q4_Col40_1.Q4_Col84[0])
f_original_Q4_Col102_144 = column(key_flattenRequest_Q4_Col40_1.Q4_Col102[0])
f_original_Q4_Col177_145 = column(key_flattenRequest_Q4_Col40_1.Q4_Col177[0])
f_original_Q4_Col178_146 = column(key_flattenRequest_Q4_Col40_1.Q4_Col178[0])
f_original_Q4_Col180_147 = column(key_flattenRequest_Q4_Col40_1.Q4_Col180[0])
f_original_Q4_Col182_148 = column(key_flattenRequest_Q4_Col40_1.Q4_Col182[0])
f_original_Q4_Col183_149 = column(key_flattenRequest_Q4_Col40_1.Q4_Col183[0])
f_original_Q4_Col166_150 = column(key_flattenRequest_Q4_Col40_1.Q4_Col166[0])
f_original_Q4_Col184_151 = column(key_flattenRequest_Q4_Col40_1.Q4_Col184[0])
f_original_Q4_Col185_152 = column(key_flattenRequest_Q4_Col40_1.Q4_Col185[0])
f_original_Q4_Col167_153 = column(key_flattenRequest_Q4_Col40_1.Q4_Col167[0])
f_original_Q4_Col169_154 = column(key_flattenRequest_Q4_Col40_1.Q4_Col169[0])
f_original_Q4_Col170_155 = column(key_flattenRequest_Q4_Col40_1.Q4_Col170[0])
f_original_Q4_Col172_156 = column(key_flattenRequest_Q4_Col40_1.Q4_Col172[0])
f_original_Q4_Col104_157 = column(key_flattenRequest_Q4_Col40_1.Q4_Col104[0])
f_original_Q4_Col100_158 = column(key_flattenRequest_Q4_Col40_1.Q4_Col100[0])
f_original_Q4_Col88_159 = column(key_flattenRequest_Q4_Col40_1.Q4_Col88[0])
f_original_Q4_Col89_160 = column(key_flattenRequest_Q4_Col40_1.Q4_Col89[0])
f_original_Q4_Col103_161 = column(key_flattenRequest_Q4_Col40_1.Q4_Col103[0])
f_original_Q4_Col101_162 = column(key_flattenRequest_Q4_Col40_1.Q4_Col101[0])
f_original_Q4_Col121_163 = column(key_flattenRequest_Q4_Col40_1.Q4_Col121[0])
f_original_Q4_Col149_164 = column(key_flattenRequest_Q4_Col40_1.Q4_Col149[0])
f_original_Q4_Col135_165 = column(key_flattenRequest_Q4_Col40_1.Q4_Col135[0])
f_original_Q4_Col122_166 = column(key_flattenRequest_Q4_Col40_1.Q4_Col122[0])
f_original_Q4_Col150_167 = column(key_flattenRequest_Q4_Col40_1.Q4_Col150[0])
f_original_Q4_Col136_168 = column(key_flattenRequest_Q4_Col40_1.Q4_Col136[0])
f_original_Q4_Col156_169 = column(key_flattenRequest_Q4_Col40_1.Q4_Col156[0])
f_original_Q4_Col49_170 = column(key_flattenRequest_Q4_Col40_1.Q4_Col49[0])
f_original_Q4_Col157_171 = column(key_flattenRequest_Q4_Col40_1.Q4_Col157[0])
f_original_Q4_Col123_172 = column(key_flattenRequest_Q4_Col40_1.Q4_Col123[0])
f_original_Q4_Col151_173 = column(key_flattenRequest_Q4_Col40_1.Q4_Col151[0])
f_original_Q4_Col137_174 = column(key_flattenRequest_Q4_Col40_1.Q4_Col137[0])
f_original_Q4_Col113_175 = column(key_flattenRequest_Q4_Col40_1.Q4_Col113[0])
f_original_Q4_Col124_176 = column(key_flattenRequest_Q4_Col40_1.Q4_Col124[0])
f_original_Q4_Col152_177 = column(key_flattenRequest_Q4_Col40_1.Q4_Col152[0])
f_original_Q4_Col138_178 = column(key_flattenRequest_Q4_Col40_1.Q4_Col138[0])
f_original_Q4_Col125_179 = column(key_flattenRequest_Q4_Col40_1.Q4_Col125[0])
f_original_Q4_Col153_180 = column(key_flattenRequest_Q4_Col40_1.Q4_Col153[0])
f_original_Q4_Col139_181 = column(key_flattenRequest_Q4_Col40_1.Q4_Col139[0])
f_original_Q4_Col43_182 = column(key_flattenRequest_Q4_Col40_1.Q4_Col43[0])
f_original_Q4_Col78_183 = column(key_flattenRequest_Q4_Col40_1.Q4_Col78[0])
f_original_Q4_Col92_184 = column(key_flattenRequest_Q4_Col40_1.Q4_Col92[0])
f_original_Q4_Col93_185 = column(key_flattenRequest_Q4_Col40_1.Q4_Col93[0])
f_original_Q4_Col91_186 = column(key_flattenRequest_Q4_Col40_1.Q4_Col91[0])
f_original_Q4_Col59_187 = column(key_flattenRequest_Q4_Col40_1.Q4_Col59[0])
f_original_Q4_Col126_188 = column(key_flattenRequest_Q4_Col40_1.Q4_Col126[0])
f_original_Q4_Col154_189 = column(key_flattenRequest_Q4_Col40_1.Q4_Col154[0])
f_original_Q4_Col140_190 = column(key_flattenRequest_Q4_Col40_1.Q4_Col140[0])
f_original_Q4_Col127_191 = column(key_flattenRequest_Q4_Col40_1.Q4_Col127[0])
f_original_Q4_Col155_192 = column(key_flattenRequest_Q4_Col40_1.Q4_Col155[0])
f_original_Q4_Col141_193 = column(key_flattenRequest_Q4_Col40_1.Q4_Col141[0])
f_original_Q4_Col161_194 = column(key_flattenRequest_Q4_Col40_1.Q4_Col161[0])
f_original_Q4_Col163_195 = column(key_flattenRequest_Q4_Col40_1.Q4_Col163[0])
f_original_Q4_Col79_196 = column(key_flattenRequest_Q4_Col40_1.Q4_Col79[0])
f_original_Q4_Col77_197 = column(key_flattenRequest_Q4_Col40_1.Q4_Col77[0])
f_original_Q4_Col98_198 = column(key_flattenRequest_Q4_Col40_1.Q4_Col98[0])
f_original_Q4_Col94_199 = column(key_flattenRequest_Q4_Col40_1.Q4_Col94[0])
f_original_Q4_Col106_200 = column(key_flattenRequest_Q4_Col40_1.Q4_Col106[0])
f_original_Q4_Col107_201 = column(key_flattenRequest_Q4_Col40_1.Q4_Col107[0])
f_original_Q4_Col111_202 = column(key_flattenRequest_Q4_Col40_1.Q4_Col111[0])
f_original_Q4_Col112_203 = column(key_flattenRequest_Q4_Col40_1.Q4_Col112[0])
f_original_Q4_Col108_204 = column(key_flattenRequest_Q4_Col40_1.Q4_Col108[0])
f_original_Q4_Col109_205 = column(key_flattenRequest_Q4_Col40_1.Q4_Col109[0])
f_original_Q4_Col158_206 = column(key_flattenRequest_Q4_Col40_1.Q4_Col158[0])
f_original_Q4_Col159_207 = column(key_flattenRequest_Q4_Col40_1.Q4_Col159[0])
f_original_Q4_Col48_208 = column(key_flattenRequest_Q4_Col40_1.Q4_Col48[0])
f_original_Q4_Col116_209 = column(key_flattenRequest_Q4_Col40_1.Q4_Col116[0])
f_original_Q4_Col144_210 = column(key_flattenRequest_Q4_Col40_1.Q4_Col144[0])
f_original_Q4_Col130_211 = column(key_flattenRequest_Q4_Col40_1.Q4_Col130[0])
f_original_Q4_Col117_212 = column(key_flattenRequest_Q4_Col40_1.Q4_Col117[0])
f_original_Q4_Col145_213 = column(key_flattenRequest_Q4_Col40_1.Q4_Col145[0])
f_original_Q4_Col131_214 = column(key_flattenRequest_Q4_Col40_1.Q4_Col131[0])
f_divide_215_216 = column(key_flattenRequest_Q4_Col40_1.Q4_Col45[0])
f_divide_215_217 = column(key_flattenRequest_Q4_Col40_1.Q4_Col39[0])
f_divide_216_218 = column(key_flattenRequest_Q4_Col40_1.Q4_Col39[0])
f_divide_216_219 = column(key_flattenRequest_Q4_Col40_1.Q4_Col45[0])
f_divide_217_220 = column(key_flattenRequest_Q4_Col40_1.Q4_Col47[0])
f_divide_217_221 = column(key_flattenRequest_Q4_Col40_1.Q4_Col39[0])
f_divide_218_222 = column(key_flattenRequest_Q4_Col40_1.Q4_Col39[0])
f_divide_218_223 = column(key_flattenRequest_Q4_Col40_1.Q4_Col47[0])
f_multiply_219_224 = column(key_flattenRequest_Q4_Col40_1.Q4_Col83[0])
f_multiply_219_225 = column(key_flattenRequest_Q4_Col40_1.Q4_Col84[0])
f_divide_220_226 = column(key_flattenRequest_Q4_Col40_1.Q4_Col47[0])
f_divide_221_228 = column(key_flattenRequest_Q4_Col40_1.Q4_Col47[0])
f_divide_221_229 = column(key_flattenRequest_Q4_Col40_1.Q4_Col45[0])
f_combine_222_230 = column(key_flattenRequest_Q4_Col40_1.Q4_Col80[0])
f_combine_222_231 = column(key_flattenRequest_Q4_Col40_1.Q4_Col92[0])
f_divide_223_232 = column(key_flattenRequest_Q4_Col40_1.Q4_Col45[0])
f_divide_223_233 = column(key_flattenRequest_Q4_Col40_1.Q4_Col47[0])
f_combine_224_234 = column(key_flattenRequest_Q4_Col40_1.Q4_Col159[0])
f_combine_225_237 = column(key_flattenRequest_Q4_Col40_1.Q4_Col160[0])
f_divide_227_240 = column(key_flattenRequest_Q4_Col40_1.Q4_Col83[0])
f_combine_228_242 = column(key_flattenRequest_Q4_Col40_1.Q4_Col157[0])
f_combine_229_244 = column(key_flattenRequest_Q4_Col40_1.Q4_Col92[0])
f_combine_231_249 = column(key_flattenRequest_Q4_Col40_1.Q4_Col180[0])
select_bo_POS_CASH_balance = select(flattenRequest, Q4_Col41 as Q4_Col0,0L as Q4_Col1,Q4_Col40 as Q4_Col2,0L as Q4_Col3,0.0D as Q4_Col199,0.0D as Q4_Col200,'' as Q4_Col21,0L as Q4_Col22,0L as Q4_Col23)
bo_POS_CASH_balance_union_window = window(table=select_bo_POS_CASH_balance, other_table=[bo_POS_CASH_balance], keys=[Q4_Col2], order=Q4_Col0, at_least=100, max_size=101, offset=0s, instance_is_window=false, output="flattenRequest_output")
f_flattenRequest_bo_POS_CASH_balance_Q4_Col199_avg_3 = column(avg(bo_POS_CASH_balance_union_window.Q4_Col199[0:100]))
f_flattenRequest_bo_POS_CASH_balance_Q4_Col199_avg_4 = column(avg(bo_POS_CASH_balance_union_window.Q4_Col199[0:10]))
f_flattenRequest_bo_POS_CASH_balance_Q4_Col200_avg_5 = column(avg(bo_POS_CASH_balance_union_window.Q4_Col200[0:10]))
f_flattenRequest_bo_POS_CASH_balance_Q4_Col199_max_27 = column(max(bo_POS_CASH_balance_union_window.Q4_Col199[0:100]))
f_flattenRequest_bo_POS_CASH_balance_Q4_Col200_max_28 = column(max(bo_POS_CASH_balance_union_window.Q4_Col200[0:100]))
f_flattenRequest_bo_POS_CASH_balance_Q4_Col200_min_47 = column(min(bo_POS_CASH_balance_union_window.Q4_Col200[0:10]))
f_flattenRequest_bo_POS_CASH_balance_Q4_Col3_top3frequency_59 = column(join(",", "NULL", range(get_keys(sort_by_value(map(group_by(bo_POS_CASH_balance_union_window[0:100], "Q4_Col3"), x->count_of_window(x)))), 0, 3)))
f_flattenRequest_bo_POS_CASH_balance_Q4_Col21_top3frequency_60 = column(join(",", "NULL", range(get_keys(sort_by_value(map(group_by(bo_POS_CASH_balance_union_window[0:100], "Q4_Col21"), x->count_of_window(x)))), 0, 3)))
f_flattenRequest_bo_POS_CASH_balance_Q4_Col22_top3frequency_61 = column(join(",", "NULL", range(get_keys(sort_by_value(map(group_by(bo_POS_CASH_balance_union_window[0:100], "Q4_Col22"), x->count_of_window(x)))), 0, 3)))
f_flattenRequest_bo_POS_CASH_balance_Q4_Col22_top3frequency_62 = column(join(",", "NULL", range(get_keys(sort_by_value(map(group_by(bo_POS_CASH_balance_union_window[0:10], "Q4_Col22"), x->count_of_window(x)))), 0, 3)))
f_flattenRequest_bo_POS_CASH_balance_Q4_Col3_distinct_count_75 = column(distinct_count(bo_POS_CASH_balance_union_window.Q4_Col3[0:100]))
f_flattenRequest_bo_POS_CASH_balance_Q4_Col3_distinct_count_76 = column(distinct_count(bo_POS_CASH_balance_union_window.Q4_Col3[0:10]))
f_flattenRequest_bo_POS_CASH_balance_Q4_Col1_distinct_count_77 = column(distinct_count(bo_POS_CASH_balance_union_window.Q4_Col1[0:100]))
f_flattenRequest_bo_POS_CASH_balance_Q4_Col23_top3frequency_224 = column(join(",", "NULL", range(get_keys(sort_by_value(map(group_by(bo_POS_CASH_balance_union_window[0:100], "Q4_Col23"), x->count_of_window(x)))), 0, 3)))
select_bo_bureau = select(flattenRequest, Q4_Col41 as Q4_Col0,Q4_Col40 as Q4_Col2,0L as Q4_Col24,'' as Q4_Col25,'' as Q4_Col26,0L as Q4_Col27,0L as Q4_Col28,0.0D as Q4_Col29,0.0D as Q4_Col30,0.0D as Q4_Col31,0L as Q4_Col32,0.0D as Q4_Col33,0.0D as Q4_Col34,0.0D as Q4_Col35,0.0D as Q4_Col36,'' as Q4_Col37,0L as Q4_Col38,0.0D as Q4_Col39)
bo_bureau_union_window = window(table=select_bo_bureau, other_table=[bo_bureau], keys=[Q4_Col2], order=Q4_Col0, at_least=100, max_size=101, offset=0s, instance_is_window=false, output="flattenRequest_output")
f_flattenRequest_bo_bureau_Q4_Col33_avg_6 = column(avg(bo_bureau_union_window.Q4_Col33[0:100]))
f_flattenRequest_bo_bureau_Q4_Col35_avg_7 = column(avg(bo_bureau_union_window.Q4_Col35[0:100]))
f_flattenRequest_bo_bureau_Q4_Col29_avg_8 = column(avg(bo_bureau_union_window.Q4_Col29[0:10]))
f_flattenRequest_bo_bureau_Q4_Col30_avg_9 = column(avg(bo_bureau_union_window.Q4_Col30[0:10]))
f_flattenRequest_bo_bureau_Q4_Col34_max_29 = column(max(bo_bureau_union_window.Q4_Col34[0:100]))
f_flattenRequest_bo_bureau_Q4_Col36_max_30 = column(max(bo_bureau_union_window.Q4_Col36[0:100]))
f_flattenRequest_bo_bureau_Q4_Col29_max_31 = column(max(bo_bureau_union_window.Q4_Col29[0:10]))
f_flattenRequest_bo_bureau_Q4_Col30_max_32 = column(max(bo_bureau_union_window.Q4_Col30[0:10]))
f_flattenRequest_bo_bureau_Q4_Col31_min_48 = column(min(bo_bureau_union_window.Q4_Col31[0:10]))
f_flattenRequest_bo_bureau_Q4_Col29_min_49 = column(min(bo_bureau_union_window.Q4_Col29[0:10]))
f_flattenRequest_bo_bureau_Q4_Col30_min_50 = column(min(bo_bureau_union_window.Q4_Col30[0:10]))
f_flattenRequest_bo_bureau_Q4_Col37_top3frequency_63 = column(join(",", "NULL", range(get_keys(sort_by_value(map(group_by(bo_bureau_union_window[0:100], "Q4_Col37"), x->count_of_window(x)))), 0, 3)))
f_flattenRequest_bo_bureau_Q4_Col27_top3frequency_64 = column(join(",", "NULL", range(get_keys(sort_by_value(map(group_by(bo_bureau_union_window[0:10], "Q4_Col27"), x->count_of_window(x)))), 0, 3)))
f_flattenRequest_bo_bureau_Q4_Col38_top3frequency_65 = column(join(",", "NULL", range(get_keys(sort_by_value(map(group_by(bo_bureau_union_window[0:10], "Q4_Col38"), x->count_of_window(x)))), 0, 3)))
f_flattenRequest_bo_bureau_Q4_Col32_distinct_count_78 = column(distinct_count(bo_bureau_union_window.Q4_Col32[0:100]))
f_flattenRequest_bo_bureau_Q4_Col25_distinct_count_79 = column(distinct_count(bo_bureau_union_window.Q4_Col25[0:100]))
f_flattenRequest_bo_bureau_Q4_Col26_distinct_count_80 = column(distinct_count(bo_bureau_union_window.Q4_Col26[0:100]))
f_flattenRequest_bo_bureau_Q4_Col28_distinct_count_81 = column(distinct_count(bo_bureau_union_window.Q4_Col28[0:100]))
f_flattenRequest_bo_bureau_Q4_Col37_distinct_count_82 = column(distinct_count(bo_bureau_union_window.Q4_Col37[0:10]))
f_flattenRequest_bo_bureau_Q4_Col27_distinct_count_83 = column(distinct_count(bo_bureau_union_window.Q4_Col27[0:10]))
f_flattenRequest_bo_bureau_Q4_Col38_distinct_count_84 = column(distinct_count(bo_bureau_union_window.Q4_Col38[0:100]))
select_bo_bureau_balance = select(flattenRequest, Q4_Col41 as Q4_Col0,0L as Q4_Col24,0L as Q4_Col3,'' as Q4_Col76,Q4_Col40 as Q4_Col2)
bo_bureau_balance_union_window = window(table=select_bo_bureau_balance, other_table=[bo_bureau_balance], keys=[Q4_Col2], order=Q4_Col0, at_least=100, max_size=101, offset=0s, instance_is_window=false, output="flattenRequest_output")
f_flattenRequest_bo_bureau_balance_Q4_Col3_top3frequency_66 = column(join(",", "NULL", range(get_keys(sort_by_value(map(group_by(bo_bureau_balance_union_window[0:10], "Q4_Col3"), x->count_of_window(x)))), 0, 3)))
select_bo_credit_card_balance = select(flattenRequest, Q4_Col41 as Q4_Col0,0L as Q4_Col1,Q4_Col40 as Q4_Col2,0L as Q4_Col3,0.0D as Q4_Col4,0L as Q4_Col5,0.0D as Q4_Col6,0.0D as Q4_Col7,0.0D as Q4_Col8,0.0D as Q4_Col9,0.0D as Q4_Col10,0.0D as Q4_Col11,0.0D as Q4_Col12,0.0D as Q4_Col13,0.0D as Q4_Col14,0.0D as Q4_Col15,0.0D as Q4_Col16,0L as Q4_Col17,0.0D as Q4_Col18,0.0D as Q4_Col19,0.0D as Q4_Col20,'' as Q4_Col21,0L as Q4_Col22,0L as Q4_Col23)
bo_credit_card_balance_union_window = window(table=select_bo_credit_card_balance, other_table=[bo_credit_card_balance], keys=[Q4_Col2], order=Q4_Col0, at_least=100, max_size=101, offset=0s, instance_is_window=false, output="flattenRequest_output")
f_flattenRequest_bo_credit_card_balance_Q4_Col5_distinct_count_85 = column(distinct_count(bo_credit_card_balance_union_window.Q4_Col5[0:10]))
f_flattenRequest_bo_credit_card_balance_Q4_Col17_distinct_count_86 = column(distinct_count(bo_credit_card_balance_union_window.Q4_Col17[0:100]))
f_flattenRequest_bo_credit_card_balance_Q4_Col17_distinct_count_87 = column(distinct_count(bo_credit_card_balance_union_window.Q4_Col17[0:10]))
f_flattenRequest_bo_credit_card_balance_Q4_Col3_distinct_count_88 = column(distinct_count(bo_credit_card_balance_union_window.Q4_Col3[0:100]))
f_flattenRequest_bo_credit_card_balance_Q4_Col21_distinct_count_89 = column(distinct_count(bo_credit_card_balance_union_window.Q4_Col21[0:100]))
f_flattenRequest_bo_credit_card_balance_Q4_Col1_distinct_count_90 = column(distinct_count(bo_credit_card_balance_union_window.Q4_Col1[0:10]))
select_bo_installment_payment = select(flattenRequest, Q4_Col41 as Q4_Col0,0L as Q4_Col1,Q4_Col40 as Q4_Col2,0.0D as Q4_Col193,0L as Q4_Col194,0.0D as Q4_Col195,0.0D as Q4_Col196,0.0D as Q4_Col197,0.0D as Q4_Col198)
bo_installment_payment_union_window = window(table=select_bo_installment_payment, other_table=[bo_installment_payment], keys=[Q4_Col2], order=Q4_Col0, at_least=100, max_size=101, offset=0s, instance_is_window=false, output="flattenRequest_output")
f_flattenRequest_bo_installment_payment_Q4_Col198_avg_10 = column(avg(bo_installment_payment_union_window.Q4_Col198[0:10]))
f_flattenRequest_bo_installment_payment_Q4_Col195_avg_11 = column(avg(bo_installment_payment_union_window.Q4_Col195[0:100]))
f_flattenRequest_bo_installment_payment_Q4_Col193_avg_12 = column(avg(bo_installment_payment_union_window.Q4_Col193[0:10]))
f_flattenRequest_bo_installment_payment_Q4_Col197_max_33 = column(max(bo_installment_payment_union_window.Q4_Col197[0:100]))
f_flattenRequest_bo_installment_payment_Q4_Col197_max_34 = column(max(bo_installment_payment_union_window.Q4_Col197[0:10]))
f_flattenRequest_bo_installment_payment_Q4_Col198_max_35 = column(max(bo_installment_payment_union_window.Q4_Col198[0:100]))
f_flattenRequest_bo_installment_payment_Q4_Col198_max_36 = column(max(bo_installment_payment_union_window.Q4_Col198[0:10]))
f_flattenRequest_bo_installment_payment_Q4_Col193_max_37 = column(max(bo_installment_payment_union_window.Q4_Col193[0:10]))
f_flattenRequest_bo_installment_payment_Q4_Col196_min_51 = column(min(bo_installment_payment_union_window.Q4_Col196[0:100]))
f_flattenRequest_bo_installment_payment_Q4_Col195_min_52 = column(min(bo_installment_payment_union_window.Q4_Col195[0:10]))
f_flattenRequest_bo_installment_payment_Q4_Col194_top3frequency_67 = column(join(",", "NULL", range(get_keys(sort_by_value(map(group_by(bo_installment_payment_union_window[0:10], "Q4_Col194"), x->count_of_window(x)))), 0, 3)))
f_flattenRequest_bo_installment_payment_Q4_Col194_distinct_count_91 = column(distinct_count(bo_installment_payment_union_window.Q4_Col194[0:100]))
f_flattenRequest_bo_installment_payment_Q4_Col1_distinct_count_92 = column(distinct_count(bo_installment_payment_union_window.Q4_Col1[0:10]))
select_bo_part = select(flattenRequest, Q4_Col41 as Q4_Col0,Q4_Col77 as Q4_Col77,Q4_Col78 as Q4_Col78,Q4_Col79 as Q4_Col79,Q4_Col80 as Q4_Col80,Q4_Col81 as Q4_Col81,0.0D as Q4_Col82,0.0D as Q4_Col83,0.0D as Q4_Col84,0.0D as Q4_Col85,0.0D as Q4_Col45,0.0D as Q4_Col39,0.0D as Q4_Col47,0.0D as Q4_Col86,0.0D as Q4_Col87)
bo_part_union_window = window(table=select_bo_part, other_table=[bo_part], keys=[Q4_Col77,Q4_Col78,Q4_Col79,Q4_Col80,Q4_Col81], order=Q4_Col0, at_least=100, max_size=101, offset=0s, instance_is_window=false, output="flattenRequest_output")
f_flattenRequest_bo_part_Q4_Col47_avg_13 = column(avg(bo_part_union_window.Q4_Col47[0:10]))
f_flattenRequest_bo_part_Q4_Col86_avg_14 = column(avg(bo_part_union_window.Q4_Col86[0:10]))
f_flattenRequest_bo_part_Q4_Col83_avg_15 = column(avg(bo_part_union_window.Q4_Col83[0:10]))
f_flattenRequest_bo_part_Q4_Col87_avg_16 = column(avg(bo_part_union_window.Q4_Col87[0:10]))
f_flattenRequest_bo_part_Q4_Col45_max_38 = column(max(bo_part_union_window.Q4_Col45[0:10]))
f_flattenRequest_bo_part_Q4_Col82_max_39 = column(max(bo_part_union_window.Q4_Col82[0:10]))
f_flattenRequest_bo_part_Q4_Col84_min_53 = column(min(bo_part_union_window.Q4_Col84[0:10]))
select_bo_previous_applicatio = select(flattenRequest, Q4_Col41 as Q4_Col0,0L as Q4_Col1,Q4_Col40 as Q4_Col2,'' as Q4_Col43,0.0D as Q4_Col39,0.0D as Q4_Col44,0.0D as Q4_Col45,0.0D as Q4_Col46,0.0D as Q4_Col47,'' as Q4_Col48,0L as Q4_Col49,'' as Q4_Col50,0L as Q4_Col51,0.0D as Q4_Col52,0.0D as Q4_Col53,0.0D as Q4_Col54,'' as Q4_Col55,'' as Q4_Col21,0L as Q4_Col56,'' as Q4_Col57,'' as Q4_Col58,'' as Q4_Col59,'' as Q4_Col60,'' as Q4_Col61,'' as Q4_Col62,'' as Q4_Col63,'' as Q4_Col64,0L as Q4_Col65,'' as Q4_Col66,0.0D as Q4_Col67,'' as Q4_Col68,'' as Q4_Col69,0.0D as Q4_Col70,0.0D as Q4_Col71,0.0D as Q4_Col72,0.0D as Q4_Col73,0.0D as Q4_Col74,0.0D as Q4_Col75)
bo_previous_applicatio_union_window = window(table=select_bo_previous_applicatio, other_table=[bo_previous_applicatio], keys=[Q4_Col2], order=Q4_Col0, at_least=100, max_size=101, offset=0s, instance_is_window=false, output="flattenRequest_output")
f_flattenRequest_bo_previous_applicatio_Q4_Col44_avg_17 = column(avg(bo_previous_applicatio_union_window.Q4_Col44[0:10]))
f_flattenRequest_bo_previous_applicatio_Q4_Col45_avg_18 = column(avg(bo_previous_applicatio_union_window.Q4_Col45[0:10]))
f_flattenRequest_bo_previous_applicatio_Q4_Col47_avg_19 = column(avg(bo_previous_applicatio_union_window.Q4_Col47[0:100]))
f_flattenRequest_bo_previous_applicatio_Q4_Col67_avg_20 = column(avg(bo_previous_applicatio_union_window.Q4_Col67[0:100]))
f_flattenRequest_bo_previous_applicatio_Q4_Col70_avg_21 = column(avg(bo_previous_applicatio_union_window.Q4_Col70[0:100]))
f_flattenRequest_bo_previous_applicatio_Q4_Col71_avg_22 = column(avg(bo_previous_applicatio_union_window.Q4_Col71[0:10]))
f_flattenRequest_bo_previous_applicatio_Q4_Col73_avg_23 = column(avg(bo_previous_applicatio_union_window.Q4_Col73[0:10]))
f_flattenRequest_bo_previous_applicatio_Q4_Col74_avg_24 = column(avg(bo_previous_applicatio_union_window.Q4_Col74[0:100]))
f_flattenRequest_bo_previous_applicatio_Q4_Col75_avg_25 = column(avg(bo_previous_applicatio_union_window.Q4_Col75[0:10]))
f_flattenRequest_bo_previous_applicatio_Q4_Col52_avg_26 = column(avg(bo_previous_applicatio_union_window.Q4_Col52[0:10]))
f_flattenRequest_bo_previous_applicatio_Q4_Col39_max_40 = column(max(bo_previous_applicatio_union_window.Q4_Col39[0:100]))
f_flattenRequest_bo_previous_applicatio_Q4_Col44_max_41 = column(max(bo_previous_applicatio_union_window.Q4_Col44[0:100]))
f_flattenRequest_bo_previous_applicatio_Q4_Col45_max_42 = column(max(bo_previous_applicatio_union_window.Q4_Col45[0:100]))
f_flattenRequest_bo_previous_applicatio_Q4_Col46_max_43 = column(max(bo_previous_applicatio_union_window.Q4_Col46[0:100]))
f_flattenRequest_bo_previous_applicatio_Q4_Col47_max_44 = column(max(bo_previous_applicatio_union_window.Q4_Col47[0:100]))
f_flattenRequest_bo_previous_applicatio_Q4_Col72_max_45 = column(max(bo_previous_applicatio_union_window.Q4_Col72[0:100]))
f_flattenRequest_bo_previous_applicatio_Q4_Col52_max_46 = column(max(bo_previous_applicatio_union_window.Q4_Col52[0:10]))
f_flattenRequest_bo_previous_applicatio_Q4_Col45_min_54 = column(min(bo_previous_applicatio_union_window.Q4_Col45[0:100]))
f_flattenRequest_bo_previous_applicatio_Q4_Col47_min_55 = column(min(bo_previous_applicatio_union_window.Q4_Col47[0:100]))
f_flattenRequest_bo_previous_applicatio_Q4_Col67_min_56 = column(min(bo_previous_applicatio_union_window.Q4_Col67[0:100]))
f_flattenRequest_bo_previous_applicatio_Q4_Col74_min_57 = column(min(bo_previous_applicatio_union_window.Q4_Col74[0:10]))
f_flattenRequest_bo_previous_applicatio_Q4_Col52_min_58 = column(min(bo_previous_applicatio_union_window.Q4_Col52[0:10]))
f_flattenRequest_bo_previous_applicatio_Q4_Col64_top3frequency_68 = column(join(",", "NULL", range(get_keys(sort_by_value(map(group_by(bo_previous_applicatio_union_window[0:100], "Q4_Col64"), x->count_of_window(x)))), 0, 3)))
f_flattenRequest_bo_previous_applicatio_Q4_Col66_top3frequency_69 = column(join(",", "NULL", range(get_keys(sort_by_value(map(group_by(bo_previous_applicatio_union_window[0:100], "Q4_Col66"), x->count_of_window(x)))), 0, 3)))
f_flattenRequest_bo_previous_applicatio_Q4_Col66_top3frequency_70 = column(join(",", "NULL", range(get_keys(sort_by_value(map(group_by(bo_previous_applicatio_union_window[0:10], "Q4_Col66"), x->count_of_window(x)))), 0, 3)))
f_flattenRequest_bo_previous_applicatio_Q4_Col59_top3frequency_71 = column(join(",", "NULL", range(get_keys(sort_by_value(map(group_by(bo_previous_applicatio_union_window[0:10], "Q4_Col59"), x->count_of_window(x)))), 0, 3)))
f_flattenRequest_bo_previous_applicatio_Q4_Col68_top3frequency_72 = column(join(",", "NULL", range(get_keys(sort_by_value(map(group_by(bo_previous_applicatio_union_window[0:10], "Q4_Col68"), x->count_of_window(x)))), 0, 3)))
f_flattenRequest_bo_previous_applicatio_Q4_Col69_top3frequency_73 = column(join(",", "NULL", range(get_keys(sort_by_value(map(group_by(bo_previous_applicatio_union_window[0:10], "Q4_Col69"), x->count_of_window(x)))), 0, 3)))
f_flattenRequest_bo_previous_applicatio_Q4_Col65_top3frequency_74 = column(join(",", "NULL", range(get_keys(sort_by_value(map(group_by(bo_previous_applicatio_union_window[0:10], "Q4_Col65"), x->count_of_window(x)))), 0, 3)))
f_flattenRequest_bo_previous_applicatio_Q4_Col64_distinct_count_93 = column(distinct_count(bo_previous_applicatio_union_window.Q4_Col64[0:100]))
f_flattenRequest_bo_previous_applicatio_Q4_Col58_distinct_count_94 = column(distinct_count(bo_previous_applicatio_union_window.Q4_Col58[0:100]))
f_flattenRequest_bo_previous_applicatio_Q4_Col56_distinct_count_95 = column(distinct_count(bo_previous_applicatio_union_window.Q4_Col56[0:100]))
f_flattenRequest_bo_previous_applicatio_Q4_Col50_distinct_count_96 = column(distinct_count(bo_previous_applicatio_union_window.Q4_Col50[0:100]))
f_flattenRequest_bo_previous_applicatio_Q4_Col49_distinct_count_97 = column(distinct_count(bo_previous_applicatio_union_window.Q4_Col49[0:10]))
f_flattenRequest_bo_previous_applicatio_Q4_Col55_distinct_count_98 = column(distinct_count(bo_previous_applicatio_union_window.Q4_Col55[0:10]))
f_flattenRequest_bo_previous_applicatio_Q4_Col21_distinct_count_99 = column(distinct_count(bo_previous_applicatio_union_window.Q4_Col21[0:100]))
f_flattenRequest_bo_previous_applicatio_Q4_Col61_distinct_count_100 = column(distinct_count(bo_previous_applicatio_union_window.Q4_Col61[0:10]))
f_flattenRequest_bo_previous_applicatio_Q4_Col57_distinct_count_101 = column(distinct_count(bo_previous_applicatio_union_window.Q4_Col57[0:10]))
f_flattenRequest_bo_previous_applicatio_Q4_Col66_distinct_count_102 = column(distinct_count(bo_previous_applicatio_union_window.Q4_Col66[0:10]))
f_flattenRequest_bo_previous_applicatio_Q4_Col68_distinct_count_103 = column(distinct_count(bo_previous_applicatio_union_window.Q4_Col68[0:10]))
f_flattenRequest_bo_previous_applicatio_Q4_Col51_distinct_count_104 = column(distinct_count(bo_previous_applicatio_union_window.Q4_Col51[0:10]))
f_flattenRequest_bo_previous_applicatio_Q4_Col69_distinct_count_105 = column(distinct_count(bo_previous_applicatio_union_window.Q4_Col69[0:100]))
f_flattenRequest_bo_previous_applicatio_Q4_Col1_distinct_count_106 = column(distinct_count(bo_previous_applicatio_union_window.Q4_Col1[0:100]))
flattenRequest_Q4_Col41_Q4_Col78 = window(table=flattenRequest, keys=[Q4_Col78], order=Q4_Col41, max_size=100, offset=10h, output="flattenRequest_output")
f_flattenRequest_window_count_Q4_Col43_226 = column(if(flattenRequest_Q4_Col41_Q4_Col78.Q4_Col43[0] != null, count(flattenRequest_Q4_Col41_Q4_Col78.Q4_Col43[0], flattenRequest_Q4_Col41_Q4_Col78.Q4_Col43[0s:10h]), null))
join_flattenRequest = select(flattenRequest, Q4_Col40 as flattenRequest_Q4_Col40, Q4_Col41 as flattenRequest_Q4_Col41, Q4_Col43 as flattenRequest_Q4_Col43, Q4_Col80 as flattenRequest_Q4_Col80, Q4_Col88 as flattenRequest_Q4_Col88, Q4_Col89 as flattenRequest_Q4_Col89, Q4_Col90 as flattenRequest_Q4_Col90, Q4_Col85 as flattenRequest_Q4_Col85, Q4_Col45 as flattenRequest_Q4_Col45, Q4_Col39 as flattenRequest_Q4_Col39, Q4_Col47 as flattenRequest_Q4_Col47, Q4_Col59 as flattenRequest_Q4_Col59, Q4_Col91 as flattenRequest_Q4_Col91, Q4_Col78 as flattenRequest_Q4_Col78, Q4_Col92 as flattenRequest_Q4_Col92, Q4_Col93 as flattenRequest_Q4_Col93, Q4_Col94 as flattenRequest_Q4_Col94, Q4_Col81 as flattenRequest_Q4_Col81, Q4_Col95 as flattenRequest_Q4_Col95, Q4_Col96 as flattenRequest_Q4_Col96, Q4_Col97 as flattenRequest_Q4_Col97, Q4_Col98 as flattenRequest_Q4_Col98, Q4_Col99 as flattenRequest_Q4_Col99, Q4_Col100 as flattenRequest_Q4_Col100, Q4_Col101 as flattenRequest_Q4_Col101, Q4_Col102 as flattenRequest_Q4_Col102, Q4_Col103 as flattenRequest_Q4_Col103, Q4_Col104 as flattenRequest_Q4_Col104, Q4_Col79 as flattenRequest_Q4_Col79, Q4_Col105 as flattenRequest_Q4_Col105, Q4_Col106 as flattenRequest_Q4_Col106, Q4_Col107 as flattenRequest_Q4_Col107, Q4_Col48 as flattenRequest_Q4_Col48, Q4_Col49 as flattenRequest_Q4_Col49, Q4_Col108 as flattenRequest_Q4_Col108, Q4_Col109 as flattenRequest_Q4_Col109, Q4_Col110 as flattenRequest_Q4_Col110, Q4_Col111 as flattenRequest_Q4_Col111, Q4_Col112 as flattenRequest_Q4_Col112, Q4_Col113 as flattenRequest_Q4_Col113, Q4_Col77 as flattenRequest_Q4_Col77, Q4_Col82 as flattenRequest_Q4_Col82, Q4_Col83 as flattenRequest_Q4_Col83, Q4_Col84 as flattenRequest_Q4_Col84, Q4_Col114 as flattenRequest_Q4_Col114, Q4_Col115 as flattenRequest_Q4_Col115, Q4_Col116 as flattenRequest_Q4_Col116, Q4_Col117 as flattenRequest_Q4_Col117, Q4_Col118 as flattenRequest_Q4_Col118, Q4_Col119 as flattenRequest_Q4_Col119, Q4_Col120 as flattenRequest_Q4_Col120, Q4_Col121 as flattenRequest_Q4_Col121, Q4_Col122 as flattenRequest_Q4_Col122, Q4_Col123 as flattenRequest_Q4_Col123, Q4_Col124 as flattenRequest_Q4_Col124, Q4_Col125 as flattenRequest_Q4_Col125, Q4_Col126 as flattenRequest_Q4_Col126, Q4_Col127 as flattenRequest_Q4_Col127, Q4_Col128 as flattenRequest_Q4_Col128, Q4_Col129 as flattenRequest_Q4_Col129, Q4_Col130 as flattenRequest_Q4_Col130, Q4_Col131 as flattenRequest_Q4_Col131, Q4_Col132 as flattenRequest_Q4_Col132, Q4_Col133 as flattenRequest_Q4_Col133, Q4_Col134 as flattenRequest_Q4_Col134, Q4_Col135 as flattenRequest_Q4_Col135, Q4_Col136 as flattenRequest_Q4_Col136, Q4_Col137 as flattenRequest_Q4_Col137, Q4_Col138 as flattenRequest_Q4_Col138, Q4_Col139 as flattenRequest_Q4_Col139, Q4_Col140 as flattenRequest_Q4_Col140, Q4_Col141 as flattenRequest_Q4_Col141, Q4_Col142 as flattenRequest_Q4_Col142, Q4_Col143 as flattenRequest_Q4_Col143, Q4_Col144 as flattenRequest_Q4_Col144, Q4_Col145 as flattenRequest_Q4_Col145, Q4_Col146 as flattenRequest_Q4_Col146, Q4_Col147 as flattenRequest_Q4_Col147, Q4_Col148 as flattenRequest_Q4_Col148, Q4_Col149 as flattenRequest_Q4_Col149, Q4_Col150 as flattenRequest_Q4_Col150, Q4_Col151 as flattenRequest_Q4_Col151, Q4_Col152 as flattenRequest_Q4_Col152, Q4_Col153 as flattenRequest_Q4_Col153, Q4_Col154 as flattenRequest_Q4_Col154, Q4_Col155 as flattenRequest_Q4_Col155, Q4_Col156 as flattenRequest_Q4_Col156, Q4_Col157 as flattenRequest_Q4_Col157, Q4_Col158 as flattenRequest_Q4_Col158, Q4_Col159 as flattenRequest_Q4_Col159, Q4_Col160 as flattenRequest_Q4_Col160, Q4_Col161 as flattenRequest_Q4_Col161, Q4_Col162 as flattenRequest_Q4_Col162, Q4_Col163 as flattenRequest_Q4_Col163, Q4_Col164 as flattenRequest_Q4_Col164, Q4_Col165 as flattenRequest_Q4_Col165, Q4_Col166 as flattenRequest_Q4_Col166, Q4_Col167 as flattenRequest_Q4_Col167, Q4_Col168 as flattenRequest_Q4_Col168, Q4_Col169 as flattenRequest_Q4_Col169, Q4_Col170 as flattenRequest_Q4_Col170, Q4_Col171 as flattenRequest_Q4_Col171, Q4_Col172 as flattenRequest_Q4_Col172, Q4_Col173 as flattenRequest_Q4_Col173, Q4_Col174 as flattenRequest_Q4_Col174, Q4_Col175 as flattenRequest_Q4_Col175, Q4_Col176 as flattenRequest_Q4_Col176, Q4_Col177 as flattenRequest_Q4_Col177, Q4_Col178 as flattenRequest_Q4_Col178, Q4_Col179 as flattenRequest_Q4_Col179, Q4_Col180 as flattenRequest_Q4_Col180, Q4_Col181 as flattenRequest_Q4_Col181, Q4_Col182 as flattenRequest_Q4_Col182, Q4_Col183 as flattenRequest_Q4_Col183, Q4_Col184 as flattenRequest_Q4_Col184, Q4_Col185 as flattenRequest_Q4_Col185, Q4_Col186 as flattenRequest_Q4_Col186, Q4_Col187 as flattenRequest_Q4_Col187, Q4_Col188 as flattenRequest_Q4_Col188, Q4_Col189 as flattenRequest_Q4_Col189, Q4_Col190 as flattenRequest_Q4_Col190, Q4_Col191 as flattenRequest_Q4_Col191, Q4_Col192 as flattenRequest_Q4_Col192)
join_action = select(action, Q4_Col40 as action_Q4_Col40, Q4_Col41 as action_Q4_Col41, Q4_Col0 as action_Q4_Col0, Q4_Col42 as action_Q4_Col42)
join_flattenRequest_join_action_left = leftjoin(join_flattenRequest, join_action, "join_flattenRequest.flattenRequest_Q4_Col40 = join_action.action_Q4_Col40")
join_flattenRequest_join_action_left_window = window(join_flattenRequest_join_action_left, "join_flattenRequest_join_action_left_join_output")
f_flattenRequest_action_Q4_Col42_direct_2 = column(join_flattenRequest_join_action_left_window.action_Q4_Col42[0])
leftjoinkey_flattenRequest_Q4_Col40 = output(join_flattenRequest_join_action_left_window.flattenRequest_Q4_Col40[0])
join_flattenRequest_join_action_left_join_output_flattenRequest_output = leftjoin(join_flattenRequest_join_action_left_join_output, flattenRequest_output, "join_flattenRequest_join_action_left_join_output.leftjoinkey_flattenRequest_Q4_Col40 = flattenRequest_output.flattenRequest_outputkey_flattenRequest_Q4_Col40")